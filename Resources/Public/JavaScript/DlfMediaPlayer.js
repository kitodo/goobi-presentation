(()=>{"use strict";var e,t={1998:(e,t,n)=>{n(3367);var r=n(885),i=n(4942),a=n(5671),o=n(3144),s=n(7326),l=n(1752),u=n(136),c=n(2963),d=n(1120),h=n(5861),f=n(7757),v=n.n(f);function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){var n=(0,r.Z)(t,2),i=n[0],a=n[1];return e<i?i:e>a?a:e}function g(e,t){return e<t?-1:e>t?1:0}function b(e,t){for(var n=e,i=0,a=Object.entries(t);i<a.length;i++){var o=(0,r.Z)(a[i],2),s=o[0],l=o[1];void 0!==l&&(n=n.split("{".concat(s,"}")).join(l))}return n}function k(e,t){return e.toString().padStart(t,"0")}function w(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return new Promise((function(r,i){e.toBlob((function(e){e?r(e):i()}),t,n)}))}function S(e){return T(e,"readAsDataURL")}function T(e,t){return new Promise((function(n,r){var i=new FileReader;i.onload=function(){"string"==typeof i.result?n(i.result):r(null)},i.onerror=function(){r(i.error)},i[t](e)}))}function P(e){return x.apply(this,arguments)}function x(){return(x=(0,h.Z)(v().mark((function e(t){var n;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=R("img")).decoding="async",n.src=t,e.next=5,n.decode();case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){"string"==typeof e?R("a",{href:e,download:t}).click():A(e,(function(e){C(e,t)}))}function A(e,t){var n,r=URL.createObjectURL(e);try{n=t(r)}catch(e){throw URL.revokeObjectURL(r),e}if(n instanceof Promise){var i=n;return new Promise((function(e,t){i.then((function(t){URL.revokeObjectURL(r),e(t)})).catch((function(e){URL.revokeObjectURL(r),t(e)}))}))}return URL.revokeObjectURL(r),n}function O(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function _(e){return e.preventDefault(),!1}function M(e){e.draggable=!1,e.ondragstart=_}function E(e,t){for(var n=[],r=Array.isArray(t)?t:[t],i=0;i<e.length;i++){if(i>0){var a,o=p(r);try{for(o.s();!(a=o.n()).done;){var s=a.value,l="string"==typeof s?s:s.cloneNode(!0);n.push(l)}}catch(e){o.e(e)}finally{o.f()}}n.push(e[i])}return n}function R(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=document.createElement(e),a=0,o=Object.entries(t);a<o.length;a++){var s=(0,r.Z)(o[a],2),l=s[0],u=s[1];"$"===l[0]?i.addEventListener(l.substring(1),u):i[l]=u}var c,d=p(n);try{for(d.s();!(c=d.n()).done;){var h=c.value;"string"==typeof h?i.append(document.createTextNode(h)):h instanceof HTMLElement&&i.append(h)}}catch(e){d.e(e)}finally{d.f()}return i}function Z(e,t,n){n?e.classList.add(t):e.classList.remove(t)}function j(e){return e.filter((function(e){return null!==e}))}function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $={None:0,Ctrl:1,Shift:2,Alt:4,Meta:8};function q(e,t,n){var r=n;return 1===t.length&&(r&=~$.Shift,"mac"===e.getKeyboardVariant()&&(r&=~$.Alt)),r}var F=n(1002);function N(e,t){for(var n=Object.assign({},t),i=0,a=Object.entries(t);i<a.length;i++){var o=(0,r.Z)(a[i],2),s=o[0],l=o[1],u=e[s],c=null!=u?u:l;switch((0,F.Z)(l)){case"boolean":n[s]=!0===c||Boolean(Number(c));break;case"number":n[s]=Number(c);break;case"string":n[s]=String(c)}}return n}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(){return(0,a.Z)(this,i),r.apply(this,arguments)}return(0,o.Z)(i,[{key:"timeToChapter",value:function(e){return this.timeToElement(e)}},{key:"filter",value:function(e){return new i(this.elements.filter(e))}}],[{key:"isEqual",value:function(e,t){var n;return e===t||null!==e&&null!==t&&e.timecode===t.timecode&&!(null===(n=globalThis.dlfUtils)||void 0===n||!n.arrayEqualsByIdentity(e.fileIds,t.fileIds))}}]),i}(function(e){function t(e){(0,a.Z)(this,t),this.elements=e.slice(),this.elements.sort((function(e,t){return e.timecode-t.timecode})),this.elementToIndex=new Map;var n,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.elements.entries());try{for(i.s();!(n=i.n()).done;){var o=(0,r.Z)(n.value,2),s=o[0],l=o[1];this.elementToIndex.set(l,s)}}catch(e){i.e(e)}finally{i.f()}}return(0,o.Z)(t,[{key:"at",value:function(e){return this.elements[e]}},{key:"indexOf",value:function(e){return this.elementToIndex.get(e)}},{key:"advance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.indexOf(e);if(void 0!==n)return this.elements[n+t]}},{key:"timeToElement",value:function(e){var t;return null===(t=this.timeToEntry(e))||void 0===t?void 0:t[1]}},{key:"timeToEntry",value:function(e){if(0!==this.elements.length){for(var t=0,n=this.elements.length-1;t+1<n;){var r=Math.floor((t+n)/2);this.elements[r].timecode<=e?t=r:n=r}var i=this.elements[n];if(i.timecode<=e)return[n,i];var a=this.elements[t];return a.timecode<=e?[t,a]:void 0}}},{key:"find",value:function(e){return this.elements.find(e)}},{key:e,value:function(){return this.elements.values()}},{key:"reversed",value:v().mark((function e(){var t;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.elements.length-1;case 1:if(!(t>=0)){e.next=7;break}return e.next=4,this.elements[t];case 4:t--,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator)),U=n(8537),V=n(6034),G=n(2407),z=n(3480),H=n.n(z),W=function e(t){if(this===window)return new e(t);this.obj=t||{},this.frameRate=this.obj.frameRate||24,this.video=document.getElementById(this.obj.id)||document.getElementsByTagName("video")[0]};(W.prototype={get:function(){return Math.floor(this.video.currentTime.toFixed(5)*this.frameRate)},listen:function(e,t){var n=this;e?this.interval=setInterval((function(){if(!n.video.paused&&!n.video.ended){var t="SMPTE"===e?n.toSMPTE():"time"===e?n.toTime():n.get();return n.obj.callback&&n.obj.callback(t,e),t}}),t||1e3/n.frameRate/2):console.log("VideoFrame: Error - The listen method requires the format parameter.")},stopListen:function(){clearInterval(this.interval)},fps:{film:24,NTSC:29.97,NTSC_Film:23.98,NTSC_HD:59.94,PAL:25,PAL_HD:50,web:30,high:60}}).toTime=function(e){var t="number"!=typeof e?this.video.currentTime:e,n=this.frameRate,r=new Date,i="hh:mm:ss"+("number"==typeof e?":ff":"");function a(e){return e<10?"0"+e:e}return r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(1e3*t),i.replace(/hh|mm|ss|ff/g,(function(e){switch(e){case"hh":return a(r.getHours()<13?r.getHours():r.getHours()-12);case"mm":return a(r.getMinutes());case"ss":return a(r.getSeconds());case"ff":return a(Math.floor(t%1*n))}}))},W.prototype.toSMPTE=function(e){if(!e)return this.toTime(this.video.currentTime);var t=Number(e),n=this.frameRate;function r(e){return e<10?"0"+e:e}var i=60*n,a=(t/(60*n*60)).toFixed(0),o=Number((t/i).toString().split(".")[0])%60,s=Number((t/n).toString().split(".")[0])%60;return r(a)+":"+r(o)+":"+r(s)+":"+r(t%n)},W.prototype.toSeconds=function(e){if(!e)return Math.floor(this.video.currentTime);var t=e.split(":");return 60*Number(t[0])*60+60*Number(t[1])+Number(t[2])},W.prototype.toMilliseconds=function(e){var t=Number(e?e.split(":")[3]:this.toSMPTE().split(":")[3]),n=1e3/this.frameRate*(isNaN(t)?0:t);return Math.floor(1e3*this.toSeconds(e)+n)},W.prototype.toFrames=function(e){var t=e?e.split(":"):this.toSMPTE().split(":"),n=this.frameRate,r=60*Number(t[0])*60*n,i=60*Number(t[1])*n,a=Number(t[2])*n,o=Number(t[3]);return Math.floor(r+i+a+o)},W.prototype.__seek=function(e,t){this.video.paused||this.video.pause();var n=Number(this.get());this.video.currentTime=("backward"===e?n-t:n+t)/this.frameRate+1e-5},W.prototype.seekForward=function(e,t){return e||(e=1),this.__seek("forward",Number(e)),!t||t()},W.prototype.seekBackward=function(e,t){return e||(e=1),this.__seek("backward",Number(e)),!t||t()},W.prototype.seekTo=function(e){var t,n,r=e||{},i=Object.keys(r)[0];if("SMPTE"==i||"time"==i)return n=r[i],t=this.toMilliseconds(n)/1e3+.001,void(this.video.currentTime=t);switch(i){case"frame":n=this.toSMPTE(r[i]),t=this.toMilliseconds(n)/1e3+.001;break;case"seconds":t=Number(r[i]);break;case"milliseconds":t=Number(r[i])/1e3+.001}isNaN(t)||(this.video.currentTime=t)};const K=W;function X(e){return"function"==typeof e?{isAvailable:function(){return!0},execute:e}:{isAvailable:null!==(t=e.isAvailable)&&void 0!==t?t:function(){return!0},execute:null!==(n=e.execute)&&void 0!==n?n:function(){return!1}};var t,n}var Y=n(4015),Q=function(){function e(){(0,a.Z)(this,e),this.idCnt=0,this.testElements={},this.lang={twoLetterIsoCode:"en",phrasesInput:{},phrasesCompiled:{}}}var t;return(0,o.Z)(e,[{key:"getLocation",value:function(){return new URL(window.location.href)}},{key:"supportsMediaSource",value:function(){return void 0!==window.MediaSource&&void 0!==window.MediaSource.isTypeSupported}},{key:"supportsCanvasExport",value:function(e){var t,n;return(t=this.getTestElement("canvas").toDataURL(e),null===(n=t.match(/data:(.*);/))||void 0===n?void 0:n[1])===e}},{key:"supportsVideoMime",value:function(e){return""!==this.getTestElement("video").canPlayType(e)}},{key:"getKeyboardVariant",value:function(){return navigator.userAgent.includes("Mac")?"mac":"ibm"}},{key:"isInFullScreen",value:function(){return null!==document.fullscreenElement}},{key:"toggleFullScreen",value:(t=(0,h.Z)(v().mark((function e(t,n){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.fullscreenElement){e.next=6;break}return screen.orientation&&screen.orientation.unlock(),e.next=4,document.exitFullscreen();case 4:e.next=25;break;case 6:if(e.prev=6,!document.pictureInPictureElement){e.next=10;break}return e.next=10,document.exitPictureInPicture();case 10:return e.next=12,t.requestFullscreen({navigationUI:"hide"});case 12:if(!n||!screen.orientation){e.next=20;break}return e.prev=13,e.next=16,screen.orientation.lock("landscape");case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(13);case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(6),console.log(e.t1);case 25:case"end":return e.stop()}}),e,null,[[6,22],[13,18]])}))),function(e,n){return t.apply(this,arguments)})},{key:"mkid",value:function(){return"__autoid_".concat(++this.idCnt)}},{key:"uuidv4",value:function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(e){var t=Number(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}},{key:"setLang",value:function(e){this.lang={twoLetterIsoCode:e.twoLetterIsoCode,phrasesInput:e.phrases,phrasesCompiled:{}}}},{key:"t",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=this.lang.phrasesCompiled[e];if(void 0===r){var i=this.lang.phrasesInput[e];if(void 0===i)return"function"==typeof n?n():(console.error("Warning: Translation key '".concat(e,"' not defined, fallback not provided.")),e);r=this.lang.phrasesCompiled[e]=new Y.ZP(i,this.lang.twoLetterIsoCode,{},{ignoreTag:!0})}return r.format(t)}},{key:"getTestElement",value:function(e){var t;return null!==(t=this.testElements[e])&&void 0!==t?t:document.createElement(e)}}]),e}();function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ee=function(){function e(){(0,a.Z)(this,e),this.__listeners=new Map}return(0,o.Z)(e,[{key:"addEventListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only ".concat(arguments.length," present."));var r=this.__listeners,i=e.toString();r.has(i)||r.set(i,new Map);var a=r.get(i);a.has(t)||a.set(t,n)}},{key:"removeEventListener",value:function(e,t){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only ".concat(arguments.length," present."));var n=this.__listeners,r=e.toString();if(n.has(r)){var i=n.get(r);i.has(t)&&i.delete(t)}}},{key:"dispatchEvent",value:function(e){if(!(e instanceof Event))throw new TypeError("Failed to execute 'dispatchEvent' on 'EventTarget': parameter 1 is not of type 'Event'.");var t=e.type,n=this.__listeners.get(t);if(n){var i,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(n.entries());try{for(a.s();!(i=a.n()).done;){var o=(0,r.Z)(i.value,2),s=o[0],l=o[1];try{"function"==typeof s?s.call(this,e):s&&"function"==typeof s.handleEvent&&s.handleEvent(e)}catch(e){setTimeout((function(){throw e}))}l&&l.once&&n.delete(s)}}catch(e){a.e(e)}finally{a.f()}}return!0}}]),e}();function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ne=function(){function e(){(0,a.Z)(this,e),this.listeners_=[]}return(0,o.Z)(e,[{key:"record",value:function(e){var t=EventTarget.prototype.addEventListener,n=ee.prototype.addEventListener,r=this;try{EventTarget.prototype.addEventListener=function(e,n,i){r.listeners_.push({target:this,type:e,callback:n,options:i}),t.call(this,e,n,i)},ee.prototype.addEventListener=function(e,t,i){r.listeners_.push({target:this,type:e,callback:t,options:i}),n.call(this,e,t,i)},e()}finally{EventTarget.prototype.addEventListener=t,ee.prototype.addEventListener=n}}},{key:"removeAll",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.listeners_);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.target.removeEventListener(n.type,n.callback,n.options)}}catch(e){t.e(e)}finally{t.f()}}}]),e}(),re=n(2982),ie=n(7187),ae=n.n(ie);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.Z)(this,e),this.config=se({tapMaxDelay:500,tapMaxDistance:20,swipeMinDistance:100,holdMinDelay:200,allowGesture:function(){return!0}},t),this.last={tapdown:null,tapup:null},this.holdTimeout=null,this.tapCount=0,this.handlers={contextmenu:this.handleContextMenu.bind(this),pointerdown:this.handlePointerDown.bind(this),pointerup:this.handlePointerUp.bind(this),pointercancel:this.handlePointerCancel.bind(this),pointerleave:this.handlePointerLeave.bind(this)},this.events=new(ae())}return(0,o.Z)(e,[{key:"register",value:function(e){e.addEventListener("contextmenu",this.handlers.contextmenu),e.addEventListener("pointerdown",this.handlers.pointerdown),e.addEventListener("pointerup",this.handlers.pointerup),e.addEventListener("pointercancel",this.handlers.pointercancel),e.addEventListener("pointerleave",this.handlers.pointerleave)}},{key:"deregister",value:function(e){e.removeEventListener("contextmenu",this.handlers.contextmenu),e.removeEventListener("pointerdown",this.handlers.pointerdown),e.removeEventListener("pointerup",this.handlers.pointerup),e.removeEventListener("pointercancel",this.handlers.pointercancel),e.removeEventListener("pointerleave",this.handlers.pointerleave)}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"handleContextMenu",value:function(e){this.release()}},{key:"handlePointerDown",value:function(e){var t=this;if(0===e.button&&this.config.allowGesture(e)){var n=this.getStat(e);"tap"===this.getContinuation(this.last.tapup,n)?this.tapCount++:this.tapCount=1;var r=this.tapCount;this.clearHold(),this.holdTimeout=setTimeout((function(){t.events.emit("gesture",{type:"hold",event:e,position:n.positionRel,tapCount:r})}),this.config.holdMinDelay),this.emitTap("tapdown",e,n)}else this.release()}},{key:"handlePointerUp",value:function(e){if(0===e.button&&this.config.allowGesture(e)){var t=this.getStat(e);this.clearHold();var n=this.getContinuation(this.last.tapdown,t);if("tap"===n)this.emitTap("tapup",e,t);else if(1===this.tapCount&&"swipe"===n){var r,i=this.last.tapdown,a=t,o=Math.atan2(i.positionPx.y-a.positionPx.y,a.positionPx.x-i.positionPx.x),s=Math.abs(o/Math.PI*180);r=s<45?"east":s<135?o>0?"north":"south":"west",this.events.emit("gesture",{type:"swipe",event:e,begin:i.positionRel,end:a.positionRel,angle:o,direction:r}),this.reset()}else this.release()}}},{key:"handlePointerCancel",value:function(e){this.release()}},{key:"handlePointerLeave",value:function(e){var t=this.last,n=t.tapdown,r=t.tapup;(null===n||null!==r&&n.date>r.date)&&this.release()}},{key:"emitTap",value:function(e,t,n){this.events.emit("gesture",{type:e,event:t,position:n.positionRel,tapCount:this.tapCount}),this.last[e]=n}},{key:"release",value:function(){var e=this.isActive;this.reset(),e&&this.events.emit("release")}},{key:"reset",value:function(){this.tapCount=0,this.clearHold(),this.last={tapdown:null,tapup:null}}},{key:"isActive",get:function(){return 0!==this.tapCount||null!==this.last.tapdown||null!==this.last.tapup}},{key:"getStat",value:function(e){var t=e.target.getBoundingClientRect(),n={x:e.clientX,y:e.clientY},r={x:e.screenX||n.x,y:e.screenY||n.y},i={x:(n.x-t.left)/t.width,y:(n.y-t.top)/t.height};return{date:new Date,positionClientPx:n,positionPx:r,positionRel:i}}},{key:"getContinuation",value:function(e,t){if(null===e)return"tap";if(t.date.valueOf()-e.date.valueOf()>this.config.tapMaxDelay)return"cancel";var n=Math.pow(t.positionPx.x-e.positionPx.x,2)+Math.pow(t.positionPx.y-e.positionPx.y,2);return n<=Math.pow(this.config.tapMaxDistance,2)?"tap":n>=Math.pow(this.config.swipeMinDistance,2)?"swipe":"cancel"}},{key:"clearHold",value:function(){null!==this.holdTimeout&&(clearTimeout(this.holdTimeout),this.holdTimeout=null)}}]),e}();function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ce=function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(e,t,n){var o,s,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,a.Z)(this,i),(s=r.call(this,e,t)).env=n;var u=null!==(o=l.element)&&void 0!==o?o:R("button");e.appendChild(u),s.dlf={config:l,element:u};var c=l.onClickAction;return s.eventManager&&c&&(s.eventManager.listen(u,"click",(function(){c.isAvailable()&&c.execute()})),s.eventManager.listen(s.player,"loaded",(function(){s.updateControlPanelButton()}))),s.updateControlPanelButton(),s}return(0,o.Z)(i,[{key:"updateControlPanelButton",value:function(){var e,t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.dlf.element.getAttributeNames());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.startsWith("data-t-")){var i=r.substring(7),a=this.dlf.element.getAttribute(r);a&&this.dlf.element.setAttribute(i,this.env.t(a))}}}catch(e){n.e(e)}finally{n.f()}var o=null!==(e=this.dlf.element.title)&&void 0!==e?e:"";this.dlf.element.ariaLabel=o,this.dlf.element.title="",Z(this.dlf.element,"shaka-tooltip",""!==o);var s=this.dlf.config.onClickAction;s&&Z(this.dlf.element,"shaka-hidden",!s.isAvailable())}}],[{key:"register",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.mkid();return H().ui.Controls.registerElement(r,{create:function(r,i){return new t(r,i,e,n)}}),r}}]),i}(H().ui.Element),de=function(){function e(){(0,a.Z)(this,e),this.tasks={}}var t;return(0,o.Z)(e,[{key:"get",value:function(e){var t,n,r=null!==(n=(t=this.tasks)[e])&&void 0!==n?n:t[e]=this.createTask(e);return this.resumeTask(r)}},{key:"getCached",value:function(e){var t,n=null===(t=this.tasks[e])||void 0===t?void 0:t.state;return 4===(null==n?void 0:n.type)?n.image:null}},{key:"abortPending",value:function(){for(var e=0,t=Object.entries(this.tasks);e<t.length;e++){var n=(0,r.Z)(t[e],2),i=(n[0],n[1]);this.stopTask(i)}}},{key:"createTask",value:function(e){return{state:{type:0,url:e},promise:null,stopNext:!1}}},{key:"stopTask",value:function(e){e.stopNext=!0}},{key:"resumeTask",value:function(e){var t=this;return e.stopNext=!1,null===e.promise&&(e.promise=new Promise(function(){var n=(0,h.Z)(v().mark((function n(r,i){return v().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.prev=0;case 1:if(4!==e.state.type){n.next=4;break}return r(e.state.image),n.abrupt("break",11);case 4:if(!e.stopNext){n.next=7;break}return e.promise=null,n.abrupt("break",11);case 7:return n.next=9,t.progressTask(e);case 9:n.next=1;break;case 11:n.next=16;break;case 13:n.prev=13,n.t0=n.catch(0),i(n.t0);case 16:case"end":return n.stop()}}),n,null,[[0,13]])})));return function(e,t){return n.apply(this,arguments)}}())),e.promise}},{key:"progressTask",value:(t=(0,h.Z)(v().mark((function e(t){var n,r,i,a,o;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.state.type,e.next=0===e.t0?3:1===e.t0?8:2===e.t0?21:3===e.t0?23:4===e.t0?28:29;break;case 3:return n=new AbortController,r=t.state.url,i=fetch(r,{signal:n.signal}),t.state={type:1,abortController:n,responsePromise:i},e.abrupt("break",29);case 8:return e.next=10,t.state.responsePromise;case 10:if(!(a=e.sent).ok){e.next=19;break}return e.t1=2,e.next=15,a.blob();case 15:e.t2=e.sent,t.state={type:e.t1,imageBlob:e.t2},e.next=20;break;case 19:throw a;case 20:case 28:return e.abrupt("break",29);case 21:return t.state={type:3,imagePromise:(s=t.state.imageBlob,A(s,P))},e.abrupt("break",29);case 23:return e.next=25,t.state.imagePromise;case 25:return o=e.sent,t.state={type:4,image:o},e.abrupt("break",29);case 29:case"end":return e.stop()}var s}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();function he(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t?"{h}:{mm}:{ss}":"{m}:{ss}";return n?(r+=":{ff}",t||(r+="f")):r+=".{00}",b(r,fe(e,n))}function fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=ve(e,null!=t?t:0);return{h:"".concat(n.hours),hh:k(n.hours,2),m:"".concat(n.totalMinutes),mm:k(n.minutes,2),ss:k(n.seconds,2),ff:k(n.frames,2),"00":k(Math.floor(100*n.fractional),2),"000":k(Math.floor(1e3*n.fractional),3)}}function ve(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Math.floor(e/3600),r=Math.floor(e/60%60),i=60*n+r,a=Math.floor(e%60),o=e%1,s=Math.floor(o*t);return{hours:n,minutes:r,totalMinutes:i,seconds:a,fractional:o,frames:s}}function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var be=160,ke=function(){function e(t){(0,a.Z)(this,e),this.seekBar=t.seekBar,this.player=t.player,this.network=t.network,this.interaction=t.interaction,this.fps=null,this.chapters=null,this.thumbnailTracks=[],this.snapToThumbnail=null,this.lastRendered=null,this.isChanging=!1,this.deltaStart=null,this.current=null,this.renderAnimationFrame=null,this.seekMode="wide",this.openDisplayTimeout=null,this.handlers={onWindowBlur:this.onWindowBlur.bind(this),onWindowResize:this.onWindowResize.bind(this),onPointerMove:this.onPointerMove.bind(this),onPointerDown:this.onPointerDown.bind(this),onPointerUpOrCancel:this.onPointerUpOrCancel.bind(this)},this.$container=R("div",{className:"dlf-media-thumbnail-preview"},[R("div",{className:"content-box"},[this.$display=R("div",{className:"display"},[this.$img=R("img")]),this.$info=R("span",{className:"info"},[this.$chapterText=R("span",{className:"chapter-text"}),this.$timecodeText=R("span",{className:"timecode-text"})])])]),this.$seekMarker=R("div",{className:"seek-marker"}),this.$seekThumbBar=R("div",{className:"seek-thumb-bar"}),this.seekBar.append(this.$seekMarker,this.$seekThumbBar,this.$container),this.ensureDisplaySize(be,90),window.addEventListener("blur",this.handlers.onWindowBlur),window.addEventListener("resize",this.handlers.onWindowResize),document.addEventListener("pointermove",this.handlers.onPointerMove),document.addEventListener("pointerdown",this.handlers.onPointerDown),document.addEventListener("pointerup",this.handlers.onPointerUpOrCancel),document.addEventListener("pointercancel",this.handlers.onPointerUpOrCancel)}var t,n,r,i,s,l,u;return(0,o.Z)(e,[{key:"release",value:function(){window.removeEventListener("blur",this.handlers.onWindowBlur),window.removeEventListener("resize",this.handlers.onWindowResize),document.removeEventListener("pointermove",this.handlers.onPointerMove),document.removeEventListener("pointerdown",this.handlers.onPointerDown),document.removeEventListener("pointerup",this.handlers.onPointerUpOrCancel),document.removeEventListener("pointercancel",this.handlers.onPointerUpOrCancel)}},{key:"setFps",value:function(e){this.fps=e,this.currentRenderBest()}},{key:"setChapters",value:function(e){this.chapters=e,this.currentRenderBest()}},{key:"setThumbnailTracks",value:(u=(0,h.Z)(v().mark((function e(t){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.thumbnailTracks=t.slice(),this.thumbnailTracks.sort((function(e,t){return t.bandwidth-e.bandwidth})),e.next=4,this.activateThumbnailSnap(!1);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"activateThumbnailSnap",value:(l=(0,h.Z)(v().mark((function e(t){var n,r,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.snapToThumbnail=t&&null!==(n=null!==(r=null===(i=this.lastRendered)||void 0===i?void 0:i.thumb.track)&&void 0!==r?r:this.thumbnailTracks[0])&&void 0!==n?n:null,!this.current){e.next=5;break}return e.next=4,this.snapPosition(this.current.rawSeekPosition);case 4:this.current.seekPosition=e.sent;case 5:this.current&&this.renderSeekPosition(this.current.seekPosition),this.currentRenderBest();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"setSeekMode",value:function(e){this.seekMode=e,this.currentRenderBest()}},{key:"onWindowBlur",value:function(){this.cancelPreview()}},{key:"onWindowResize",value:function(){this.cancelPreview()}},{key:"onPointerMove",value:(s=(0,h.Z)(v().mark((function e(t){var n,r,i,a,o,s,l,u;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=this.mouseEventToPosition(t))){e.next=3;break}return e.abrupt("return",this.setIsVisible(!1));case 3:return e.next=5,this.snapPosition(n);case 5:if(r=e.sent,"touch"===t.pointerType&&this.beginChange(),i=[],!this.showThumbnailImage()){e.next=14;break}return a=r.seconds,o=.01*this.player.getStats().estimatedBandwidth,e.next=13,this.getThumbnails(a,o);case 13:i=e.sent;case 14:s=null===this.current,this.current={rawSeekPosition:n,seekPosition:r,thumbs:i},this.isChanging&&0!=(1&t.buttons)&&(null===(l=this.interaction)||void 0===l||null===(u=l.onChange)||void 0===u||u.call(l,r)),this.currentRenderBest(s);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"onPointerDown",value:(i=(0,h.Z)(v().mark((function e(t){var n,r,i,a;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0==(1&t.buttons)){e.next=8;break}if(void 0===(n=this.mouseEventToPosition(t,"mouse"===t.pointerType))){e.next=8;break}return e.next=5,this.snapPosition(n);case 5:a=e.sent,this.beginChange(),null===(r=this.interaction)||void 0===r||null===(i=r.onChange)||void 0===i||i.call(r,a);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onPointerUpOrCancel",value:function(e){this.endChange(),"mouse"===e.pointerType&&void 0!==this.mouseEventToPosition(e)||this.setIsVisible(!1)}},{key:"mouseEventToPosition",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.saneVideoDuration();if(void 0!==n){var r=null!==document.querySelector("input[type=button]:hover, button:hover");if(!r){var i=this.seekBar.getBoundingClientRect(),a=i.left;if(null!==this.deltaStart){var o=i.width/n;a=this.deltaStart.clientX-this.deltaStart.seconds*o}if(!this.isChanging)if(this.isVisible&&t){var s=i.right,l=i.bottom;if(!(a<=e.clientX&&e.clientX<=s&&e.clientY<=l))return;var u="wide"===this.seekMode?this.$container.getBoundingClientRect():this.seekBar.getBoundingClientRect(),c=u.top;if(null!==this.openDisplayTimeout&&(c+=(l-c)/2),!(c<=e.clientY))return}else if(!(e.target instanceof Node&&this.seekBar.contains(e.target)))return;var d=n/i.width,h=y(e.clientX-a,[0,i.width]);return{absoluteRaw:h,secondsPerPixel:d}}}}},{key:"snapPosition",value:(r=(0,h.Z)(v().mark((function e(t){var n,r,i,a,o,s,l;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.absoluteRaw,i=t.secondsPerPixel,a=r*i,o=null===(n=this.chapters)||void 0===n?void 0:n.timeToChapter(a+2*i),s=!1,this.isChanging){e.next=11;break}if(null===this.snapToThumbnail){e.next=10;break}return e.next=8,this.getSingleThumbnail(this.snapToThumbnail,a);case 8:null!==(l=e.sent)&&(a=l.imageTime,r=a/i);case 10:o&&(a-o.timecode)/i<6&&(null===this.snapToThumbnail&&(a=o.timecode,r=a/i),s=!0);case 11:return e.abrupt("return",{absolute:r,seconds:a,chapter:o,onChapterMarker:s});case 12:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"ensureDisplaySize",value:function(e,t){var n=Math.floor(be/e*t);this.$display.clientHeight!==n&&(this.$display.style.height="".concat(n,"px"))}},{key:"currentRenderBest",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&null===this.openDisplayTimeout?this.openDisplayTimeout=setTimeout((function(){e.openDisplayTimeout=null,e.currentRenderBest()}),100):null===this.openDisplayTimeout&&null===this.renderAnimationFrame&&(this.renderAnimationFrame=window.requestAnimationFrame((function(){e.renderAnimationFrame=null;var t=e.current;if(null!==t){e.setIsVisible(!0,t.thumbs.length>0,!1),e.renderSeekPosition(t.seekPosition);var n,r=ye(t.thumbs);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.uris[0];if(void 0!==a){var o=e.network.getCached(a);if(null!==o){e.renderImageAndShow(a,i,o,t.seekPosition);break}e.network.get(a).then((function(){e.currentRenderBest()}))}}}catch(e){r.e(e)}finally{r.f()}}})))}},{key:"renderImageAndShow",value:function(e,t,n,r){this.ensureDisplaySize(t.width,t.height),this.renderImage(e,t,n),this.setIsVisible(!0),this.positionContainer(r),this.renderSeekPosition(r,t)}},{key:"renderImage",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=r||null===this.lastRendered||t.imageTime!==this.lastRendered.thumb.imageTime||t.bandwidth!==this.lastRendered.thumb.bandwidth;if(i){var a=t.positionX,o=t.positionY,s=t.width,l=(t.height,be/s);this.$img.replaceWith(n),this.$img=n,this.$img.style.transform=["scale(".concat(l,")"),"translateX(-".concat(a,"px)"),"translateY(-".concat(o,"px)")].join(" "),this.$img.style.transformOrigin="left top",this.lastRendered={uri:e,thumb:t,tilesetImage:n}}}},{key:"positionContainer",value:function(e){var t=y(e.absolute-this.$container.offsetWidth/2,[0,this.seekBar.clientWidth-this.$container.offsetWidth]);this.$container.style.left="".concat(t,"px")}},{key:"renderSeekPosition",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.saneVideoDuration();if(void 0!==i){this.$seekMarker.style.left="".concat(e.absolute,"px"),null!==r&&null!==this.snapToThumbnail&&(this.$seekThumbBar.style.left="".concat(r.startTime/i*100,"%"),this.$seekThumbBar.style.width="".concat(r.duration/i*100,"%")),e.onChapterMarker?this.$info.classList.add("on-chapter-marker"):this.$info.classList.remove("on-chapter-marker");var a=null!==(t=null===(n=e.chapter)||void 0===n?void 0:n.title)&&void 0!==t?t:"";this.$chapterText.innerText=a,Z(this.$chapterText,"displayed",""!==a),this.$timecodeText.innerText=he(e.seconds,i>=3600,this.fps),this.positionContainer(e)}else this.setIsVisible(!1)}},{key:"cancelPreview",value:function(){this.setIsVisible(!1),this.endChange()}},{key:"beginChange",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isChanging||(this.deltaStart=this.convertDelta(n),null===(e=this.interaction)||void 0===e||null===(t=e.onChangeStart)||void 0===t||t.call(e),document.body.classList.add("seek-or-scrub"),this.isChanging=!0)}},{key:"convertDelta",value:function(e){if(null===e)return null;var t=this.player.getMediaElement();return null===t?null:{clientX:e,seconds:t.currentTime}}},{key:"endChange",value:function(){var e,t;this.isChanging&&(this.deltaStart=null,null===(e=this.interaction)||void 0===e||null===(t=e.onChangeEnd)||void 0===t||t.call(e),document.body.classList.remove("seek-or-scrub"),this.isChanging=!1)}},{key:"isVisible",get:function(){return null!==this.current}},{key:"setIsVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e||(this.current=null),Z(this.$container,"dlf-visible",e),Z(this.$seekMarker,"dlf-visible",e),Z(this.$seekThumbBar,"dlf-visible",n&&null!==this.snapToThumbnail),Z(this.$display,"is-open",t),Z(this.$img,"dlf-visible",n),M(this.$img)}},{key:"getThumbnails",value:(n=(0,h.Z)(v().mark((function e(t,n){var r,i,a,o,s=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],null!==this.snapToThumbnail?r=[this.snapToThumbnail]:void 0!==(i=this.thumbnailTracks.find((function(e){return e.bandwidth<n})))&&(a=this.thumbnailTracks[this.thumbnailTracks.length-1],r=i===a?[i]:[i,a]),o=r.map((function(e){return s.getSingleThumbnail(e,t)})),e.t0=j,e.next=6,Promise.all(o);case 6:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getSingleThumbnail",value:(t=(0,h.Z)(v().mark((function e(t,n){var r,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getThumb(n);case 2:if(r=e.sent,i=this.saneVideoDuration(),null!==r&&void 0!==i){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",(o=i,(a=r).startTime<o&&a.imageTime<o?me(me({},a),{},{duration:Math.min(a.duration,o-a.startTime)}):null));case 7:case"end":return e.stop()}var a,o}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"showThumbnailImage",value:function(){var e,t=this.player.getMediaElement();return 300<=.4*(null!==(e=null==t?void 0:t.clientHeight)&&void 0!==e?e:0)}},{key:"saneVideoDuration",value:function(){var e,t=null===(e=this.player.getMediaElement())||void 0===e?void 0:e.duration;return void 0!==t&&t>0?t:void 0}}]),e}();function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Se=function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(e,t){var n,o;return(0,a.Z)(this,i),(n=r.call(this,e,t)).$container=R("div",{className:"dlf-media-flat-seek-bar"},[n.$range=R("div",{className:"range"})]),e.prepend(n.$container),n.dlf={mediaProperties:{poster:null,chapters:null,fps:null,variantGroups:null},hasRenderedChapters:!1,value:0,uiConfig:t.getConfig(),wasPlaying:!1,seekTimer:null,thumbnailPreview:null,lastGradientStr:""},n.dlf.seekTimer=new(H().util.Timer)((function(){var e;null!==n.video&&(n.video.currentTime=n.getValue(),null===(e=n.controls)||void 0===e||e.dispatchEvent(new CustomEvent("dlf-media-manual-seek",{})))})),null!==n.player&&(n.dlf.thumbnailPreview=new ke({seekBar:n.$container,player:n.player,network:new de,interaction:{onChangeStart:function(){var e;null===(e=n.controls)||void 0===e||e.setSeeking(!0),null!==n.video&&(n.dlf.wasPlaying=!n.video.paused,n.video.pause())},onChange:function(e){var t;n.dlf.value=e.seconds,n.update(),null===(t=n.dlf.seekTimer)||void 0===t||t.tickAfter(.125)},onChangeEnd:function(){var e,t,r;null===(e=n.dlf.seekTimer)||void 0===e||e.tickNow(),null===(t=n.controls)||void 0===t||t.setSeeking(!1),n.dlf.wasPlaying&&(null===(r=n.video)||void 0===r||r.play())}}})),n.eventManager&&(n.eventManager.listen(n.player,"loaded",(function(){n.update()})),n.eventManager.listen(n.player,"variantchanged",(function(){n.updatePreviewImageTracks()})),n.eventManager.listen(n.controls,"dlf-media-properties",(function(e){var t=e.detail;n.dlf.mediaProperties=t.fullProps;var r,i,a,o=t.updateProps,s=o.chapters,l=o.fps,u=o.variantGroups;void 0!==s&&(n.dlf.hasRenderedChapters=!1,null===(r=n.dlf.thumbnailPreview)||void 0===r||r.setChapters(s),n.update()),void 0!==l&&(null===(i=n.dlf.thumbnailPreview)||void 0===i||i.setFps(null!==(a=null==l?void 0:l.rate)&&void 0!==a?a:null)),u&&n.updatePreviewImageTracks()})),null===(o=n.controls)||void 0===o||o.dispatchEvent(new CustomEvent("dlf-media-seek-bar",{detail:{seekBar:(0,s.Z)(n)}}))),n}return(0,o.Z)(i,[{key:"release",value:function(){null!==this.dlf.seekTimer&&(this.dlf.seekTimer.stop(),this.dlf.seekTimer=null),null!==this.dlf.thumbnailPreview&&(this.dlf.thumbnailPreview.release(),this.dlf.thumbnailPreview=null),(0,l.Z)((0,d.Z)(i.prototype),"release",this).call(this)}},{key:"thumbnailPreview",get:function(){return this.dlf.thumbnailPreview}},{key:"isThumbnailPreviewOpen",value:function(){var e,t;return null!==(e=null===(t=this.dlf.thumbnailPreview)||void 0===t?void 0:t.isVisible)&&void 0!==e&&e}},{key:"endSeek",value:function(){var e,t;null===(e=this.dlf.thumbnailPreview)||void 0===e||e.endChange(),null===(t=this.dlf.thumbnailPreview)||void 0===t||t.setIsVisible(!1)}},{key:"setThumbnailSnap",value:function(e){var t;null===(t=this.dlf.thumbnailPreview)||void 0===t||t.activateThumbnailSnap(e)}},{key:"renderChapterMarkers",value:function(e,t){this.$range.querySelectorAll(".dlf-media-chapter-marker").forEach((function(e){e.remove()}));var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(r.s();!(n=r.n()).done;){var i=n.value.timecode/t;if(0<=i&&i<1){var a=document.createElement("span");a.className="dlf-media-chapter-marker",a.style.position="absolute",a.style.left="".concat(100*i,"%"),this.$range.append(a)}}}catch(e){r.e(e)}finally{r.f()}}},{key:"updatePreviewImageTracks",value:function(){if(null!==this.dlf.thumbnailPreview){var e=this.dlf.mediaProperties.variantGroups;if(null!==e){var t=e.findThumbnailTracks();this.dlf.thumbnailPreview.setThumbnailTracks(t)}}else console.warn("FlatSeekBar: Missing thumbnail preview")}},{key:"getValue",value:function(){return this.dlf.value}},{key:"isShowing",value:function(){return!0}},{key:"setValue",value:function(e){var t;null!==(t=this.controls)&&void 0!==t&&t.isSeeking()||(this.dlf.value=e)}},{key:"makeColor",value:function(e,t){return"".concat(e," ").concat(100*t,"%")}},{key:"update",value:function(){if(null!==this.video){var e=this.video.duration;if(e>0){var t=this.dlf.mediaProperties.chapters;null==t||this.dlf.hasRenderedChapters||(this.renderChapterMarkers(t,e),this.dlf.hasRenderedChapters=!0);var n=getComputedStyle(this.$container),r={base:n.getPropertyValue("--base-color")||"rgba(255, 255, 255, 0.3)",buffered:n.getPropertyValue("--buffered-color")||"rgba(255, 255, 255, 0.54)",played:n.getPropertyValue("--played-color")||"rgb(255, 255, 255)"},i=this.getValue(),a=this.video.buffered.length,o=a?this.video.buffered.start(0):0,s=a?this.video.buffered.end(a-1):0,l={start:0,end:e},u=l.end-l.start,c=Math.max(o,l.start),d=Math.min(s,l.end),h=Math.min(Math.max(i,l.start),l.end),f=(c-l.start)/u||0,v=(d-l.start)/u||0,p=(h-l.start)/u||0,m=this.dlf.uiConfig.showUnbufferedStart?r.base:r.played,y="linear-gradient("+["to right",this.makeColor(m,f),this.makeColor(r.played,f),this.makeColor(r.played,p),this.makeColor(r.buffered,p),this.makeColor(r.buffered,v),this.makeColor(r.base,v)].join(",")+")";y!==this.dlf.lastGradientStr&&(this.dlf.lastGradientStr=y,this.$range.style.background=y)}}else console.warn("FlatSeekBar: Missing video")}}],[{key:"register",value:function(){H().ui.Controls.registerSeekBar({create:function(e,t){return new i(e,t)}})}}]),i}(H().ui.Element);function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe=function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(e,t,n){var o,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,a.Z)(this,i);var u=R("button",{className:"material-icons-round shaka-fullscreen-button shaka-tooltip"},["fullscreen"]);return u.setAttribute("data-t-title","control.bookmark.tooltip"),(o=r.call(this,e,t,n,Pe(Pe({},l),{},{element:u}))).eventManager&&o.eventManager.listen(document,"fullscreenchange",o.updateFullScreenButton.bind((0,s.Z)(o))),o.updateFullScreenButton(),o}return(0,o.Z)(i,[{key:"updateControlPanelButton",value:function(){}},{key:"updateFullScreenButton",value:function(){document.fullscreenEnabled?(this.dlf.element.textContent=document.fullscreenElement?"fullscreen_exit":"fullscreen",this.dlf.element.ariaLabel=document.fullscreenElement?this.env.t("control.fullscreen_exit.tooltip"):this.env.t("control.fullscreen.tooltip")):this.dlf.element.classList.add("shaka-hidden")}}]),i}(ce);H().ui.SettingsMenu;var Ce=function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(e,t,n){var o,s;return(0,a.Z)(this,i),(s=r.call(this,e,t)).$container=R("div",{className:"shaka-range-container dlf-playrate-slider"},[s.$input=R("input",{className:"shaka-range-element",type:"range",valueAsNumber:Math.log2((null===(o=s.player)||void 0===o?void 0:o.getPlaybackRate())||1),min:"-1",max:"1",step:"0.01",$input:function(){var e,t=Math.pow(2,s.$input.valueAsNumber),n=null===(e=s.player)||void 0===e?void 0:e.getMediaElement();n&&(n.playbackRate=t,n.defaultPlaybackRate=t)}})]),null!==s.player&&s.menu.insertBefore(s.$container,s.backButton.nextSibling),null!==s.eventManager&&s.eventManager.listen(s.player,"ratechange",(function(){if(null!==s.player){var e=s.player.getPlaybackRate();s.$input.valueAsNumber=Math.log2(e);var t="".concat(e.toLocaleString(void 0,{maximumFractionDigits:2}),"x");s.currentSelection.textContent=t,s.button.setAttribute("shaka-status",t)}})),s}return(0,o.Z)(i,null,[{key:"register",value:function(e){var t=e.mkid();return H().ui.OverflowMenu.registerElement(t,{create:function(t,n){return new i(t,n,e)}}),t}}]),i}(H().ui.PlaybackRateSelection);var Ae=function(e){(0,u.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function l(e,t,n){var i;(0,a.Z)(this,l),i=r.call(this,e,t);var o=R("button",{className:"shaka-current-time shaka-tooltip",ariaLabel:n.t("control.time.tooltip")});if(e.appendChild(o),i.dlf={env:n,currentTime:o},i.state={isReady:!1,activeMode:0,totalSeconds:0,duration:0,mediaProperties:{chapters:null,fps:null}},i.eventManager){i.eventManager.listen(o,"click",(function(){i.render({activeMode:(i.state.activeMode+1)%3})}));var u=i.updateTime.bind((0,s.Z)(i));i.eventManager.listen(i.controls,"timeandseekrangeupdated",u),i.eventManager.listen(i.controls,"dlf-media-properties",(function(e){var t=e.detail;i.render({mediaProperties:t.fullProps})}))}return i}return(0,o.Z)(l,[{key:"updateTime",value:function(){if(null===this.controls||null===this.video||this.video.readyState<1)this.render({isReady:!1});else{var e=this.video.duration;e>=0||(e=0),this.render({isReady:!0,duration:e,totalSeconds:y(this.controls.getDisplayTime(),[0,e])})}}},{key:"render",value:function(e){var t=this,n=Object.assign({},this.state,e);if(Object.keys(e).some((function(n){return e[n]!==t.state[n]}))){var r,a,o=null!==(r=(a={},(0,i.Z)(a,0,"current-time"),(0,i.Z)(a,1,"remaining-time"),(0,i.Z)(a,2,"current-frame"),a)[n.activeMode])&&void 0!==r?r:"current-time";this.dlf.currentTime.textContent=this.getTimecodeText(o,n)}this.state=n}},{key:"getTimecodeText",value:function(e,t){var n=t.isReady,r=t.totalSeconds,i=t.duration,a=t.mediaProperties;if(n&&0!==i){var o,s=i>=3600,l=a.chapters,u=a.fps,c=null!==(o=null==u?void 0:u.rate)&&void 0!==o?o:null,d={get chapterTitle(){var e,t;return null!==(e=null==l||null===(t=l.timeToChapter(r))||void 0===t?void 0:t.title)&&void 0!==e?e:"_"},get currentTime(){return he(r,s,c)},get totalTime(){return he(i,s,c)},get remainingTime(){return he(i-r,s,c)},get currentFrame(){var e;return null!==(e=null==u?void 0:u.vifa.get())&&void 0!==e?e:-1}};return this.dlf.env.t("control.time.".concat(e,".text"),d)}return this.dlf.env.t("player.loading")}}],[{key:"register",value:function(e){var t=e.mkid();return H().ui.Controls.registerElement(t,{create:function(t,n){return new l(t,n,e)}}),t}}]),l}(H().ui.Element);function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Me=function(){function e(t,n){(0,a.Z)(this,e),this.player=t,this.track=n}var t;return(0,o.Z)(e,[{key:"bandwidth",get:function(){return this.track.bandwidth}},{key:"getThumb",value:(t=(0,h.Z)(v().mark((function e(t){var n;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.player.getThumbnails(this.track.id,t);case 2:if(null!==(n=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",_e(_e({track:this},n),{},{imageTime:n.startTime+n.duration/2-1e-5,bandwidth:this.track.bandwidth}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();function Ee(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ze=function(e){function t(e){if((0,a.Z)(this,t),this.player=e,this.manifest=e.getManifest(),this.groupKeys=[],this.groups=[],this.keyToGroup={},null!==this.manifest){var n,r=Ee(this.manifest.variants);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.addVariant(i)}}catch(e){r.e(e)}finally{r.f()}}else console.warn("Manifest not available")}return(0,o.Z)(t,[{key:"addVariant",value:function(e){var n=e.video;if(n){var r=t.splitRepresentationId(n.originalId).group,i=this.getGroupOrCreate(r);i.variants.push(e);var a,o=Ee(n.roles);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.roles.add(s)}}catch(e){o.e(e)}finally{o.f()}n.primary&&(i.hasPrimary=!0)}}},{key:"numGroups",get:function(){return this.groupKeys.length}},{key:"getGroupOrCreate",value:function(e){var t=this.keyToGroup[e];return t||(t=this.keyToGroup[e]={key:e,variants:[],roles:new Set,hasPrimary:!1},this.groupKeys.push(e),this.groups.push(t)),t}},{key:"findActiveTrack",value:function(){return this.player.getVariantTracks().find((function(e){return e.active}))}},{key:"findThumbnailTracks",value:function(){var e,n,r=[],i=null===(e=this.findActiveGroup())||void 0===e?void 0:e.key,a=Ee(this.player.getImageTracks());try{for(a.s();!(n=a.n()).done;){var o=n.value;t.splitRepresentationId(o.originalImageId).group===i&&r.push(new Me(this.player,o))}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"findActiveGroup",value:function(){var e=this.findActiveTrack();if(e){var n=t.splitRepresentationId(e.originalVideoId).group;return this.keyToGroup[n]}}},{key:"selectGroup",value:function(e){if(this.manifest){if(this.manifest.variants!==e.variants){var t,n=this.findActiveTrack();this.manifest.variants=e.variants,this.player.selectAudioLanguage(null!==(t=null==n?void 0:n.language)&&void 0!==t?t:"und")}}else console.warn("Cannot select group: Manifest not available")}},{key:"trySelectGroup",value:function(e){return!!e&&(this.selectGroup(e),!0)}},{key:"selectGroupByKey",value:function(e){return this.trySelectGroup(this.keyToGroup[e])}},{key:"selectGroupByIndex",value:function(e){return this.trySelectGroup(this.groups[e])}},{key:"selectGroupByRole",value:function(e){return this.trySelectGroup(this.groups.find((function(t){return t.roles.has(e)})))}},{key:"selectGroupWithPrimary",value:function(){return this.trySelectGroup(this.groups.find((function(e){return e.hasPrimary})))}},{key:e,value:v().mark((function e(){var t;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=v().keys(this.keyToGroup);case 1:if((e.t1=e.t0()).done){e.next=7;break}return t=e.t1.value,e.next=5,this.keyToGroup[t];case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}],[{key:"splitRepresentationId",value:function(e){var t,n,r=(null!=e?e:"").split("#");return{id:null!==(t=r[0])&&void 0!==t?t:null,group:null!==(n=r[1])&&void 0!==n?n:"Standard"}}}]),t}(Symbol.iterator);function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ie=function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(e,t,n){var o;return(0,a.Z)(this,i),(o=r.call(this,e,t,"switch_video")).dlf={env:n,activeCheck:R("i",{className:"material-icons-round shaka-chosen-item"},["done"]),variantGroups:null},o.updateStrings(),o.updateVisibility(),o.menuButtons={},o.eventManager&&(o.eventManager.listen(o.controls,"dlf-media-properties",(function(e){var t=e.detail.updateProps.variantGroups;if(void 0!==t)try{o.setVariantGroups(t)}catch(e){console.error(e)}})),o.eventManager.listen(o.player,"variantchanged",(function(){o.markActiveGroup()}))),o}return(0,o.Z)(i,[{key:"setVariantGroups",value:function(e){var t=this;if(this.dlf.variantGroups=e,this.clearMenu(),this.updateVisibility(),null!==e){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?je(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{var i=function(){var e=n.value,r=R("button",{$click:function(){var n;null===(n=t.dlf.variantGroups)||void 0===n||n.selectGroupByKey(e.key)}},[R("span",{},[e.key])]);t.menu.appendChild(r),t.menuButtons[e.key]=r};for(r.s();!(n=r.n()).done;)i()}catch(e){r.e(e)}finally{r.f()}this.markActiveGroup()}}},{key:"clearMenu",value:function(){for(var e=0,t=Object.values(this.menuButtons);e<t.length;e++)t[e].remove();this.menuButtons={}}},{key:"markActiveGroup",value:function(){var e,t,n=null===(e=this.dlf.variantGroups)||void 0===e?void 0:e.findActiveGroup();n&&(null===(t=this.menuButtons[n.key])||void 0===t||t.appendChild(this.dlf.activeCheck),this.currentSelection.textContent=n.key)}},{key:"updateVisibility",value:function(){var e,t;(null!==(e=null===(t=this.dlf.variantGroups)||void 0===t?void 0:t.numGroups)&&void 0!==e?e:0)>0?this.button.classList.remove("shaka-hidden"):this.button.classList.add("shaka-hidden")}},{key:"updateStrings",value:function(){var e=this.dlf.env.t("control.back"),t=this.dlf.env.t("control.video-track.title");this.backButton.ariaLabel=e,this.button.ariaLabel=t,this.nameSpan.textContent=t,this.backSpan.textContent=t}}],[{key:"register",value:function(e){var t=e.mkid();return H().ui.OverflowMenu.registerElement(t,{create:function(t,n){return new i(t,n,e)}}),t}}]),i}(H().ui.SettingsMenu);function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $e=function(){function e(t,n,r,i){var o=this;(0,a.Z)(this,e),this.constants={minBottomControlsReadyState:2},this.env=t,this.eventMgr_=n,this.player=r,this.media=i,this.mediaProperties={poster:null,chapters:null,fps:null,variantGroups:null},this.lastReadyState=0,this.playerProperties={mode:"audio",locale:"",state:"poster",error:null,controlElements:[],actions:{},playerView:null},this.overflowMenuButtons=[],this.shakaBottomControls=null,this.shakaBottomControlElements=[],this.seekBar_=null,this.$container=R("div",{className:"dlf-media-player dlf-shaka"},[this.$videoBox=R("div",{className:"dlf-media-shaka-box"},[this.$video=i,this.$poster=R("img",{className:"dlf-media-poster dlf-visible",$error:function(){o.hidePoster()}})]),this.$errorBox=R("div",{className:"dlf-media-shaka-box dlf-media-error"})]),this.ui=new(H().ui.Overlay)(this.player,this.$videoBox,this.media),this.controls=this.ui.getControls(),this.configureTimeout=null,this.isConfigured=!1,this.gestures_=new le({allowGesture:this.allowGesture.bind(this)}),this.handlers={onControlsErrorEvent:this.onControlsErrorEvent.bind(this),onPlay:this.onPlay.bind(this),onTimeUpdate:this.onTimeUpdate.bind(this),afterManualSeek:this.afterManualSeek.bind(this)},this.registerEventHandlers(),this.scheduleConfigure()}return(0,o.Z)(e,[{key:"destroy",value:function(){this.controls.destroy(),this.gestures_.deregister(this.$videoBox)}},{key:"registerEventHandlers",value:function(){var e=this;this.controls.addEventListener("error",this.handlers.onControlsErrorEvent),this.controls.addEventListener("dlf-media-seek-bar",(function(t){var n=t.detail;e.seekBar_=n.seekBar,e.autosetSeekMode()})),this.controls.addEventListener("dlf-media-manual-seek",this.handlers.afterManualSeek),this.controls.addEventListener("timeandseekrangeupdated",this.handlers.onTimeUpdate),this.media.addEventListener("play",this.handlers.onPlay),this.gestures_.register(this.$videoBox)}},{key:"domElement",get:function(){return this.$container}},{key:"seekBar",get:function(){return this.seekBar_}},{key:"gestures",get:function(){return this.gestures_}},{key:"updateMediaProperties",value:function(e){Object.assign(this.mediaProperties,e),this.notifyMediaProperties(this.mediaProperties,e)}},{key:"notifyMediaProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mediaProperties,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;void 0!==t.poster&&this.renderPoster();var n=new CustomEvent("dlf-media-properties",{detail:{updateProps:t,fullProps:e}});this.controls.dispatchEvent(n)}},{key:"updatePlayerProperties",value:function(e){for(var t,n=void 0!==e.mode&&(!this.isConfigured||e.mode!==this.playerProperties.mode)||void 0!==e.controlElements&&(!this.isConfigured||e.controlElements!==this.playerProperties.controlElements),i=0,a=Object.entries(e);i<a.length;i++){var o=(0,r.Z)(a[i],2),s=o[0],l=o[1];void 0!==l&&(this.playerProperties[s]=l)}void 0!==e.locale&&(null===(t=this.controls.getLocalization())||void 0===t||t.changeLocale([e.locale])),void 0!==e.state&&this.renderPoster(),void 0!==e.error&&this.renderError(),n&&this.scheduleConfigure()}},{key:"handleEscape",value:function(){var e,t;return null!==(e=this.seekBar)&&void 0!==e&&e.isThumbnailPreviewOpen()?(null===(t=this.seekBar)||void 0===t||t.endSeek(),!0):!!this.controls.anySettingsMenusAreOpen()&&(this.controls.hideSettingsMenus(),!0)}},{key:"afterManualSeek",value:function(){this.hidePoster()}},{key:"alwaysPrependBottomControl",value:function(e){this.prependBottomControl(e),this.shakaBottomControlElements.push(e)}},{key:"prependBottomControl",value:function(e){if("video"===this.playerProperties.mode){var t;null===(t=this.shakaBottomControls)||void 0===t||t.prepend(e)}else{var n=this.$container.parentElement;null!==n&&null!==n.parentElement&&n.parentElement.insertBefore(e,n)}}},{key:"addOverflowButton",value:function(){var e;(e=this.overflowMenuButtons).push.apply(e,arguments),this.scheduleConfigure()}},{key:"scheduleConfigure",value:function(){var e=this;null===this.configureTimeout&&(this.configureTimeout=setTimeout((function(){e.configureTimeout=null,e.configure()})))}},{key:"configure",value:function(){var e;if(Se.register(),this.$container.setAttribute("data-mode",this.playerProperties.mode),null===(e=this.playerProperties.playerView)||void 0===e||e.setAttribute("data-mode",this.playerProperties.mode),this.ui.configure(this.getShakaConfiguration()),this.isConfigured=!0,this.autosetSeekMode(),this.$videoBox.dispatchEvent(new MouseEvent("mousemove")),this.shakaBottomControls=this.$videoBox.querySelector(".shaka-bottom-controls"),null!==this.shakaBottomControls){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.shakaBottomControlElements);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.prependBottomControl(r)}}catch(e){n.e(e)}finally{n.f()}}this.notifyMediaProperties()}},{key:"autosetSeekMode",value:function(){var e,t,n="audio"===this.playerProperties.mode?"narrow":"wide";null===(e=this.seekBar_)||void 0===e||null===(t=e.thumbnailPreview)||void 0===t||t.setSeekMode(n)}},{key:"getShakaConfiguration",value:function(){var e=this.playerProperties.mode,t=this.playerProperties.controlElements,n=getComputedStyle(this.$container);return{addSeekBar:!0,enableTooltips:!0,controlPanelElements:["play_pause",Ae.register(this.env),"spacer"].concat((0,re.Z)(t.map(this.makeControlElement.bind(this))),["overflow_menu"]),overflowMenuButtons:["language",Ie.register(this.env),Ce.register(this.env),"loop","quality","picture_in_picture","captions"].concat((0,re.Z)(this.overflowMenuButtons)),addBigPlayButton:"video"===e,fadeDelay:"audio"===e?1e8:void 0,volumeBarColors:{base:n.getPropertyValue("--volume-base-color")||"rgba(255, 255, 255, 0.54)",level:n.getPropertyValue("--volume-level-color")||"rgb(255, 255, 255)"},enableKeyboardPlaybackControls:!1,doubleClickForFullscreen:!1,singleClickForPlayAndPause:!1}}},{key:"makeControlElement",value:function(e){var t=this.playerProperties.actions,n=e.getAttribute("data-type");if(null===n){var r,i=null!==(r=e.getAttribute("data-action"))&&void 0!==r?r:"";return ce.register(this.env,{element:e,onClickAction:X({isAvailable:function(){var e,n;return null!==(e=null===(n=t[i])||void 0===n?void 0:n.isAvailable())&&void 0!==e&&e},execute:function(){var e;null===(e=t[i])||void 0===e||e.execute()}})})}return"fullscreen"===n?xe.register(this.env,{onClickAction:t["fullscreen.toggle"]}):n}},{key:"hidePoster",value:function(){this.$poster.classList.remove("dlf-visible")}},{key:"renderPoster",value:function(){var e=null!==this.mediaProperties.poster&&"poster"===this.playerProperties.state;e&&(this.$poster.src=this.mediaProperties.poster),Z(this.$poster,"dlf-visible",e)}},{key:"renderError",value:function(){null===this.playerProperties.error?Z(this.$errorBox,"dlf-visible",!1):(Z(this.$errorBox,"dlf-visible",!0),this.$errorBox.textContent=this.env.t(this.playerProperties.error))}},{key:"allowGesture",value:function(e){var t,n,r=this.$videoBox.getBoundingClientRect(),i=null!==(t=null===(n=this.shakaBottomControls)||void 0===n?void 0:n.getBoundingClientRect().height)&&void 0!==t?t:0,a=r.bottom-i-20;return!(e.clientY>=a)&&e.target===this.$videoBox.querySelector(".shaka-play-button-container")}},{key:"onControlsErrorEvent",value:function(e){if(e instanceof CustomEvent){var t=e.detail;console.error("Error from Shaka controls",t.code,t)}}},{key:"onPlay",value:function(){this.hidePoster()}},{key:"onTimeUpdate",value:function(){var e=this.media.readyState;e!==this.lastReadyState&&this.updateBottomControlsVisibility(e)}},{key:"updateBottomControlsVisibility",value:function(e){var t;if(0===e)null===(t=this.shakaBottomControls)||void 0===t||t.classList.remove("dlf-visible");else if(e>=this.constants.minBottomControlsReadyState){var n;null===(n=this.shakaBottomControls)||void 0===n||n.classList.add("dlf-visible")}}}]),e}();function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=function(e){(0,u.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function s(){var e;return(0,a.Z)(this,s),(e=i.call(this)).cnt_=0,e.activeSegment_=null,e.segments_={},e}return(0,o.Z)(s,[{key:"activeSegment",get:function(){return this.activeSegment_}},{key:"add",value:function(e){var t,n=null!==(t=e.id)&&void 0!==t?t:this.makeId(),r=this.segments_[n]=Fe(Fe({labelText:"",editable:!0},e),{},{id:n,toTimeRange:function(){var e;return{startTime:this.startTime,endTime:null!==(e=this.endTime)&&void 0!==e?e:null}}});return this.dispatchEvent(new CustomEvent("add",{detail:{segments:[r]}})),this.activateSegmentById(r.id),r}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.segments_[e.id],i=Object.assign({},n);if(void 0!==n){for(var a=0,o=Object.entries(e);a<o.length;a++){var s=(0,r.Z)(o[a],2),l=s[0],u=s[1];void 0!==u&&(n[l]=u)}this.dispatchEvent(new CustomEvent("update",{detail:{segment:n,prevSegment:i}})),t&&this.activateSegment(n)}}},{key:"removeById",value:function(e){var t=this.segments_[e];delete this.segments_[e],void 0!==t&&this.dispatchEvent(new CustomEvent("remove",{detail:{segments:[t]}})),null!==this.activeSegment_&&e===this.activeSegment_.id&&this.activateSegment(null)}},{key:"removeAll",value:function(){this.segments_={},this.dispatchEvent(new CustomEvent("remove_all",{detail:{}})),this.activateSegment(null)}},{key:"activateSegmentById",value:function(e){var t=this.segments_[e];void 0!==t&&this.activateSegment(t)}},{key:"activateSegment",value:function(e){e!==this.activeSegment_&&(this.activeSegment_=e,this.dispatchEvent(new CustomEvent("activate_segment",{detail:{segment:this.activeSegment_}})))}},{key:"getSegment",value:function(e){return this.segments_[e]}},{key:"getSegments",value:function(){return Object.values(this.segments_)}},{key:"makeId",value:function(){return"dlf.segments.".concat(this.cnt_++)}}]),s}(ee);function Le(e){return"audio"===e||"video"===e}function De(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ue(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ve=function(e){(0,u.Z)(p,e);var t,n,r,i,l,f=(i=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,d.Z)(i);if(l){var n=(0,d.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function p(){var e;return(0,a.Z)(this,p),e=f.call(this),p.hasInstalledPolyfills||(H().polyfill.installAll(),p.hasInstalledPolyfills=!0),e.config=null,e.env=new Q,e.eventMgr_=new ne,e.constants=e.constantDefaults(),e.dlf={handlers:{onDomContentLoaded:e.onDomContentLoaded.bind((0,s.Z)(e)),onPlayerErrorEvent:e.onPlayerErrorEvent.bind((0,s.Z)(e)),onTrackChange:e.onTrackChange.bind((0,s.Z)(e)),onTick:e.onTick.bind((0,s.Z)(e)),onPlay:e.onPlay.bind((0,s.Z)(e))}},e.video=R("video",{id:e.env.mkid(),className:"dlf-media"}),e.videoPausedOn=null,e.currentSource=null,e.timeRange=null,e.player=new(H().Player)(e.video),e.fps=null,e.variantGroups=null,e.chapters_=new D([]),e.currentChapter=null,e.markers_=new Ne,e.frontend=new $e(e.env,e.eventMgr_,e.player,e.video),e.playerView=null,e.autoplay_=!1,e.mode="auto",e.hasBeenConnected_=!1,e.__dlfRegisterEvents(),e.actions=e.getActions(),e}return(0,o.Z)(p,[{key:"getEnv",value:function(){return this.env}},{key:"getMarkers",value:function(){return this.markers_}},{key:"connectedCallback",value:function(){var e=this;if(!this.hasBeenConnected_){this.hasBeenConnected_=!0;var t=this.getConfig();this.env.setLang(t.lang);var n,r=this.getAttribute("autoplay");this.autoplay_=null!==r&&"false"!==r,this.timeRange=this.getTimeRange(),null!==this.timeRange&&this.markers_.add({id:"dlf.segment_shared",startTime:this.timeRange.startTime,endTime:null!==(n=this.timeRange.endTime)&&void 0!==n?n:void 0,labelText:this.env.t("share.shared_timecode"),editable:!1});var i=this.getAttribute("player-view");null!==i&&(this.playerView=document.getElementById(i)),this.configureFrontend(t),setTimeout((function(){e.loadSources(),e.parseChapters()})),this.appendChild(this.frontend.domElement),this.frontend.domElement.className+=" ".concat(this.className)}}},{key:"destroy",value:function(){this.eventMgr_.removeAll(),this.player.destroy(),this.frontend.destroy(),this.remove()}},{key:"configureFrontend",value:function(e){var t=Array.from(this.querySelectorAll("dlf-media-controls *")).filter((function(e){return e instanceof HTMLElement})),n=this.getAttribute("mode"),r=void 0;if("auto"===n){var i=this.getAttribute("mode-fallback");Le(i)&&(r=i),this.mode=n}else Le(n)&&(this.mode=r=n);this.frontend.updatePlayerProperties({locale:e.lang.twoLetterIsoCode,mode:r,controlElements:t,actions:this.actions,playerView:this.playerView});var a=this.getAttribute("poster");null!==a&&this.frontend.updateMediaProperties({poster:a})}},{key:"getConfig",value:function(){var e=this.config;if(null===e){var t=this.getAttribute("config");e=t?window[t]:{lang:{locale:"en_US.UTF8",twoLetterIsoCode:"en",phrases:{}}},this.config=e}return e}},{key:"constantDefaults",value:function(){return{prevChapterTolerance:5,volumeStep:.05,seekStep:5,trickPlayFactor:4,forceLandscapeOnFullscreen:!0}}},{key:"getActions",value:function(){var e=this;return{"fullscreen.toggle":X({isAvailable:function(){return document.fullscreenEnabled},execute:function(){var t;null===(t=e.frontend.seekBar)||void 0===t||t.endSeek(),e.toggleFullScreen()}}),"playback.toggle":X((function(){e.video.paused?e.video.play():e.video.pause()})),"playback.volume.mute.toggle":X((function(){e.video.muted=!e.video.muted})),"playback.volume.inc":X((function(){e.volume=e.volume+e.constants.volumeStep})),"playback.volume.dec":X((function(){e.volume=e.volume-e.constants.volumeStep})),"playback.captions.toggle":X({isAvailable:function(){return e.player.getTextTracks().length>0},execute:function(){e.showCaptions=!e.showCaptions}}),"navigate.rewind":X((function(){e.skipSeconds(-e.constants.seekStep)})),"navigate.seek":X((function(){e.skipSeconds(+e.constants.seekStep)})),"navigate.continuous-rewind":X((function(){e.ensureTrickPlay(-e.constants.trickPlayFactor)})),"navigate.continuous-seek":X((function(){e.ensureTrickPlay(e.constants.trickPlayFactor)})),"navigate.chapter.prev":X((function(){e.prevChapter()})),"navigate.chapter.next":X((function(){e.nextChapter()})),"navigate.frame.prev":X({isAvailable:function(){return null!==e.fps},execute:function(){var t;null===(t=e.fps)||void 0===t||t.vifa.seekBackward(1),e.frontend.afterManualSeek()}}),"navigate.frame.next":X({isAvailable:function(){return null!==e.fps},execute:function(){var t;null===(t=e.fps)||void 0===t||t.vifa.seekForward(1),e.frontend.afterManualSeek()}}),"navigate.position.percental":X((function(t,n){if(void 0!==t&&void 0!==n&&0<=n&&n<t.keys.length){var r=n/t.keys.length*e.video.duration;e.seekTo(r)}})),"navigate.thumbnails.snap":X({isAvailable:function(){return null!==e.variantGroups&&e.variantGroups.findThumbnailTracks().length>0},execute:function(t,n,r){var i;null===(i=e.frontend.seekBar)||void 0===i||i.setThumbnailSnap("down"===r)}}),"sound_tools.mode.audio":X({execute:function(){e.ui.updatePlayerProperties({mode:"audio"})}}),"sound_tools.mode.video":X({isAvailable:function(){return!e.player.isAudioOnly()},execute:function(){e.ui.updatePlayerProperties({mode:"video"})}}),"sound_tools.segments.add":X({execute:function(){e.markers_.add({startTime:e.displayTime})}}),"sound_tools.segments.close":X({execute:function(){var t=e.markers_.activeSegment,n=e.displayTime;null!==t&&t.startTime<n&&e.markers_.update({id:t.id,endTime:n})}})}}},{key:"addActions",value:function(e){Object.assign(this.actions,e)}},{key:"getTimeRange",value:function(){return this.parseTimeRange(this.getAttribute("start"),this.getAttribute("end"))}},{key:"parseTimeRange",value:function(e,t){if(!e)return null;var n=parseFloat(e);if(!(n>=0))return null;var r=t?parseFloat(t):null;return null===r||r>=n||(r=null),{startTime:n,endTime:r}}},{key:"__dlfRegisterEvents",value:function(){var e=this;this.eventMgr_.record((function(){window.addEventListener("DOMContentLoaded",e.dlf.handlers.onDomContentLoaded),e.player.addEventListener("error",e.dlf.handlers.onPlayerErrorEvent),e.player.addEventListener("adaptation",e.dlf.handlers.onTrackChange),e.player.addEventListener("variantchanged",e.dlf.handlers.onTrackChange),e.video.addEventListener("play",e.dlf.handlers.onPlay)})),this.tickInterval=setInterval(this.dlf.handlers.onTick,50),this.registerGestures()}},{key:"registerGestures",value:function(){var e=this,t=this.frontend.gestures;null!==t&&(t.on("gesture",(function(t){switch(t.type){case"tapup":"mouse"===t.event.pointerType?(t.tapCount<=2&&e.actions["playback.toggle"].execute(),2===t.tapCount&&e.actions["fullscreen.toggle"].execute()):t.tapCount>=2&&(t.position.x<1/3?e.actions["navigate.rewind"].execute():t.position.x>2/3?e.actions["navigate.seek"].execute():2!==t.tapCount||e.env.isInFullScreen()||e.actions["fullscreen.toggle"].execute());break;case"hold":var n,r;1===t.tapCount?null===(n=e.frontend.seekBar)||void 0===n||null===(r=n.thumbnailPreview)||void 0===r||r.beginChange(t.event.clientX):t.tapCount>=2&&(t.position.x<1/3?e.actions["navigate.continuous-rewind"].execute():t.position.x>2/3&&e.actions["navigate.continuous-seek"].execute());break;case"swipe":"east"===t.direction?e.actions["navigate.rewind"].execute():"west"===t.direction&&e.actions["navigate.seek"].execute()}})),t.on("release",(function(){var t;null===(t=e.frontend.seekBar)||void 0===t||t.endSeek(),e.cancelTrickPlay()})))}},{key:"ui",get:function(){return this.frontend}},{key:"supportsMimeType",value:function(e){switch(e){case"application/dash+xml":case"application/x-mpegurl":case"application/vnd.apple.mpegurl":return this.env.supportsMediaSource()||this.env.supportsVideoMime(e);default:return this.env.supportsVideoMime(e)}}},{key:"loadSources",value:function(){var e=[];this.querySelectorAll("source").forEach((function(t){var n=t.getAttribute("src"),r=t.getAttribute("type");if(n&&r){var i=null,a=t.getAttribute("data-fps");if(null!==a){var o=parseFloat(a);o>0&&(i=o)}var s=t.getAttribute("data-fileid");e.push({url:n,mimeType:r,frameRate:i,fileId:s})}else console.warn("Ignoring <source> that does not specify URL or MIME type")})),this.loadOneOf(e)}},{key:"loadOneOf",value:(r=(0,h.Z)(v().mark((function e(t){var n,r,i,a;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=3;break}return this.frontend.updatePlayerProperties({error:"error.no-media-source"}),e.abrupt("return",!1);case 3:n=!1,r=De(t),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=25;break}if(a=i.value,this.supportsMimeType(a.mimeType)){e.next=12;break}return n=!0,e.abrupt("continue",23);case 12:return e.prev=12,e.next=15,this.loadManifest(a);case 15:return this.frontend.updatePlayerProperties({error:null,mode:"auto"===this.mode?this.player.isAudioOnly()?"audio":"video":void 0}),this.loaded(),e.abrupt("return",!0);case 20:e.prev=20,e.t0=e.catch(12),console.error(e.t0);case 23:e.next=7;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(5),r.e(e.t1);case 30:return e.prev=30,r.f(),e.finish(30);case 33:return this.frontend.updatePlayerProperties({error:n?"error.playback-not-supported":"error.load-failed"}),e.abrupt("return",!1);case 35:case"end":return e.stop()}}),e,this,[[5,27,30,33],[12,20]])}))),function(e){return r.apply(this,arguments)})},{key:"loadManifest",value:(n=(0,h.Z)(v().mark((function e(t){var n,r,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null!==(n=null===(r=this.timeRange)||void 0===r?void 0:r.startTime)&&void 0!==n?n:null,e.next=3,this.player.load(t.url,i,t.mimeType);case 3:this.currentSource=t,this.variantGroups=new Ze(this.player),this.variantGroups.selectGroupWithPrimary()||this.variantGroups.selectGroupByRole("main")||this.variantGroups.selectGroupByIndex(0),this.frontend.updateMediaProperties({variantGroups:this.variantGroups,chapters:this.chaptersInFile}),this.updateFrameRate();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onDomContentLoaded",value:function(){}},{key:"onTick",value:function(){var e,t=null!==(e=this.chaptersInFile.timeToChapter(this.video.currentTime))&&void 0!==e?e:null;if(t!==this.currentChapter){var n=this.currentChapter;this.currentChapter=t;var r=new CustomEvent("chapterchange",{detail:{curChapter:t,prevChapter:n}});this.dispatchEvent(r)}}},{key:"onTrackChange",value:function(){this.updateFrameRate()}},{key:"updateFrameRate",value:function(){var e,t,n,r,i,a=null!==(e=null!==(t=null===(n=this.variantGroups)||void 0===n||null===(r=n.findActiveTrack())||void 0===r?void 0:r.frameRate)&&void 0!==t?t:null===(i=this.currentSource)||void 0===i?void 0:i.frameRate)&&void 0!==e?e:null;null===a?this.fps=null:null!==this.fps&&a===this.fps.rate||(this.fps={rate:a,vifa:new K({id:this.video.id,frameRate:a})}),this.frontend.updateMediaProperties({fps:this.fps})}},{key:"onPlay",value:function(){this.videoPausedOn=null}},{key:"toggleFullScreen",value:(t=(0,h.Z)(v().mark((function e(){var t;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.env.toggleFullScreen(null!==(t=this.playerView)&&void 0!==t?t:this.ui.domElement,this.constants.forceLandscapeOnFullscreen);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"parseChapters",value:function(){var e=[];this.querySelectorAll("dlf-chapter").forEach((function(t){var n=t.getAttribute("title"),r=Number(t.getAttribute("timecode"));if(n&&r>=0){var i=[],a=t.getAttribute("fileids");null!==a&&(i=a.split(","));var o=null,s=t.getAttribute("pageNo");null!==s&&(o=parseInt(s,10)),e.push({title:n,timecode:r,fileIds:i,pageNo:o})}else console.warn("Ignoring invalid <dlf-chapter>")})),this.setChapters(new D(e))}},{key:"chapters",get:function(){return this.chapters_}},{key:"chaptersInFile",get:function(){var e=this;return this.chapters_.filter((function(t){return e.isChapterInFile(t)}))}},{key:"isChapterInFile",value:function(e){return null===this.currentSource||null===this.currentSource.fileId||e.fileIds.includes(this.currentSource.fileId)}},{key:"setChapters",value:function(e){this.chapters_=e,this.frontend.updateMediaProperties({chapters:this.chaptersInFile})}},{key:"loaded",value:function(){this.autoplay_&&this.video.play()}},{key:"hasVideo",get:function(){return null!==this.currentSource}},{key:"getCurrentChapter",value:function(){return this.timeToChapter(this.video.currentTime)}},{key:"timeToChapter",value:function(e){return this.chaptersInFile.timeToChapter(e)}},{key:"media",get:function(){return this.video}},{key:"hasCurrentData",get:function(){return this.video.readyState>=2}},{key:"showCaptions",get:function(){return this.player.isTextTrackVisible()},set:function(e){this.player.setTextTrackVisibility(e)}},{key:"isAudioOnly",value:function(){return this.player.isAudioOnly()}},{key:"volume",get:function(){return this.video.volume},set:function(e){this.video.volume=y(e,[0,1])}},{key:"displayTime",get:function(){var e,t;return null!==(e=null===(t=this.frontend.seekBar)||void 0===t?void 0:t.getValue())&&void 0!==e?e:this.video.currentTime}},{key:"pauseOn",value:function(e){null!==this.videoPausedOn||this.video.paused||(this.videoPausedOn=e,this.video.pause())}},{key:"resumeOn",value:function(e){this.videoPausedOn===e&&this.video.play()}},{key:"getFps",value:function(){var e,t;return null!==(e=null===(t=this.fps)||void 0===t?void 0:t.rate)&&void 0!==e?e:null}},{key:"seekTo",value:function(e){return"number"==typeof e?(this.seekToTime(e),!0):"number"==typeof e.timecode&&this.seekToChapter(e)}},{key:"seekToTime",value:function(e){this.video.currentTime=e,this.frontend.afterManualSeek()}},{key:"seekToChapter",value:function(e){return!!this.isChapterInFile(e)&&(this.seekToTime(e.timecode),!0)}},{key:"skipSeconds",value:function(e){this.seekTo(this.video.currentTime+e)}},{key:"prevChapter",value:function(){var e=this.constants.prevChapterTolerance,t=this.timeToChapter(this.video.currentTime-e);this.seekTo(null!=t?t:0)}},{key:"nextChapter",value:function(){var e=this.getCurrentChapter();if(e){var t=this.chaptersInFile.advance(e,1);t&&this.seekTo(t)}}},{key:"ensureTrickPlay",value:function(e){this.player.getPlaybackRate()!==e&&this.player.trickPlay(e)}},{key:"cancelTrickPlay",value:function(){try{return this.player.cancelTrickPlay(),!0}catch(e){return!1}}},{key:"onPlayerErrorEvent",value:function(e){if(e instanceof CustomEvent){var t=e.detail;console.error("Error from Shaka player",t.code,t)}}}]),p}((0,G.Z)(HTMLElement));(0,i.Z)(Ve,"hasInstalledPolyfills",!1),customElements.define("dlf-media",Ve);var Ge=function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(){var e;return(0,a.Z)(this,i),(e=r.call(this)).env=new Q,e.player=null,e.hasAttached=!1,e}return(0,o.Z)(i,[{key:"forPlayer",get:function(){return this.getAttribute("forPlayer")},set:function(e){null===e?this.removeAttribute("forPlayer"):this.setAttribute("forPlayer",e)}},{key:"connectedCallback",value:function(){var e=this;this.isConnected&&(this.hasAttached||(setTimeout((function(){var t=e.forPlayer;if(null!==t){var n=document.getElementById(t);n instanceof Ve&&(e.env=n.getEnv(),e.player=n,e.attachToPlayer(n))}})),this.hasAttached=!0))}},{key:"attachToPlayer",value:function(e){}}]),i}((0,G.Z)(HTMLElement));function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return We(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ke=function(e){(0,u.Z)(m,e);var t,n,l,f,p=(l=m,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,d.Z)(l);if(f){var n=(0,d.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function m(){var e;(0,a.Z)(this,m);var t=(e=p.call(this)).attachShadow({mode:"open"});return e.$style=R("style",{},["\n      .container {\n        position: relative;\n        display: block;\n        height: 100px;\n      }\n\n      .wave-overview {\n        position: absolute;\n        bottom: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(255, 255, 255, 0.3);\n      }\n    "]),e.$container=R("div",{className:"container"},[e.$waveOverview=R("div",{className:"wave-overview"})]),t.append(e.$style,e.$container),e.nextUrl=null,e.peaks_=null,e.waveformdata=null,e.minSamplesPerPixel=0,e.maxSamplesPerPixel=Number.POSITIVE_INFINITY,e.samplesPerPixel=0,e.zoomview=null,e.handlers={onWheel:e.onWheel.bind((0,s.Z)(e)),onResize:e.onResize.bind((0,s.Z)(e))},e.peaksHandlers={"points.dragend":function(t){null!==e.player&&void 0!==t.point.id&&e.player.getMarkers().update({id:t.point.id,startTime:t.point.time,labelText:t.point.labelText,color:t.point.color},!0)},"segments.dragend":function(t){null!==e.player&&void 0!==t.segment.id&&e.player.getMarkers().update({id:t.segment.id,startTime:t.segment.startTime,endTime:t.segment.endTime,labelText:t.segment.labelText,color:"string"==typeof t.segment.color?t.segment.color:void 0},!0)}},e.markersHandlers={remove:function(t){var n,r=He(t.detail.segments);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!==e.peaks_&&(void 0===i.endTime?e.peaks_.points.removeById(i.id):e.peaks_.segments.removeById(i.id))}}catch(e){r.e(e)}finally{r.f()}},remove_all:function(){null!==e.peaks_&&(e.peaks_.points.removeAll(),e.peaks_.segments.removeAll())},add:function(t){e.peaksAddSegments(t.detail.segments)},update:function(t){var n=t.detail,r=n.segment,a=n.prevSegment;if(null!==e.peaks_)if(void 0===a.endTime&&void 0!==r.endTime)e.peaks_.points.removeById(r.id),e.peaks_.segments.add({id:r.id,startTime:r.startTime,endTime:r.endTime,labelText:r.labelText,color:r.color,editable:r.editable});else if(void 0===r.endTime){var o;null===(o=e.peaks_.points.getPoint(r.id))||void 0===o||o.update(r)}else{var s;null===(s=e.peaks_.segments.getSegment(r.id))||void 0===s||s.update(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({time:r.startTime},r))}}},e.registerEventHandlers(),e}return(0,o.Z)(m,[{key:"attributeChangedCallback",value:function(e,t,n){"hidden"===e&&(this.hidden||this.tryInitPeaks())}},{key:"registerEventHandlers",value:function(){this.$waveOverview.addEventListener("wheel",this.handlers.onWheel),"ResizeObserver"in globalThis?new ResizeObserver(this.handlers.onResize).observe(this.$container):window.addEventListener("resize",this.handlers.onResize)}},{key:"attachToPlayer",value:(n=(0,h.Z)(v().mark((function e(t){var n,r,i=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getAttribute("src"),r=this.getAttribute("type"),n&&"application/vnd.kitodo.audiowaveform"===r){e.next=4;break}return e.abrupt("return");case 4:t.addActions({"sound_tools.waveform.toggle":X({execute:function(){i.hidden=!i.hidden}})}),this.adaptPeaksMarkers(),t.ui instanceof $e&&t.ui.alwaysPrependBottomControl(this),t.media.addEventListener("loadedmetadata",(function(e){i.updateZoom(i.maxSamplesPerPixel)})),this.load(n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"load",value:(t=(0,h.Z)(v().mark((function e(t){var n,r;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextUrl=t,e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.arrayBuffer();case 6:r=e.sent,t===this.nextUrl&&(this.waveformdata=U.Z.create(r),this.updateZoom(this.maxSamplesPerPixel),this.tryInitPeaks());case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"tryInitPeaks",value:function(){var e,t=this,n=this.waveformdata;if(null===this.peaks_&&!this.hidden&&null!=(null===(e=this.player)||void 0===e?void 0:e.media)&&null!==n){var r={logger:function(){var e;(e=console).log.apply(e,arguments)},mediaElement:this.player.media,zoomview:{container:this.$waveOverview},waveformData:{arraybuffer:n.toArrayBuffer()},waveformCache:!0};V.Z.init(r,(function(e,r){var i,a;r?(r.player.seek=function(e){var n;null===(n=t.player)||void 0===n||n.seekTo(e)},t.peaks_=r,t.zoomview=r.views.getView("zoomview"),null===(i=t.zoomview)||void 0===i||i.setZoom({seconds:n.duration}),null===(a=t.zoomview)||void 0===a||a.setWheelMode("scroll"),t.adaptPeaksMarkers()):console.log(e)}))}}},{key:"adaptPeaksMarkers",value:function(){if(null!==this.peaks_&&null!==this.player){this.peaksAddSegments(this.player.getMarkers().getSegments());for(var e=0,t=Object.entries(this.peaksHandlers);e<t.length;e++){var n=(0,r.Z)(t[e],2),i=n[0],a=n[1];this.peaks_.on(i,a)}for(var o=0,s=Object.entries(this.markersHandlers);o<s.length;o++){var l=(0,r.Z)(s[o],2),u=l[0],c=l[1];this.player.getMarkers().addEventListener(u,c)}}}},{key:"peaksAddSegments",value:function(e){if(null!==this.peaks_){var t,n=He(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;void 0===r.endTime?this.peaks_.points.add({id:r.id,time:r.startTime,labelText:r.labelText,color:r.color,editable:r.editable}):this.peaks_.segments.add({id:r.id,startTime:r.startTime,endTime:r.endTime,labelText:r.labelText,color:r.color,editable:r.editable})}}catch(e){n.e(e)}finally{n.f()}}}},{key:"onWheel",value:function(e){var t=Math.pow(1.5,-e.deltaY/100);this.updateZoom(this.samplesPerPixel/t)}},{key:"onResize",value:function(){var e;null===(e=this.zoomview)||void 0===e||e.fitToContainer(),this.updateZoom()}},{key:"updateZoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.samplesPerPixel;if(null!==this.waveformdata){var t=this.waveformdata,n=t.sample_rate,r=t.seconds_per_pixel,i=t.duration;this.minSamplesPerPixel=r*n,this.maxSamplesPerPixel=y(i*n/this.$waveOverview.offsetWidth,[this.minSamplesPerPixel,Number.POSITIVE_INFINITY]),this.samplesPerPixel=y(e,[this.minSamplesPerPixel,this.maxSamplesPerPixel]),null!==this.zoomview&&this.zoomview.setZoom({scale:this.samplesPerPixel})}}}],[{key:"observedAttributes",get:function(){return["hidden"]}}]),m}(Ge);function Xe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ye(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}customElements.define("dlf-waveform",Ke),window.DlfMediaPlayer=Ve;var Qe=n(2592);const Je=jQuery;var et=n.n(Je);function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var rt=function(e){(0,u.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function l(e,t){var n;return(0,a.Z)(this,l),n=r.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({show:!1},t)),n.parent=e,n.isAnimating=!1,n.$main=R("div",{className:"sxnd-modal"},[n.$headline=R("div",{className:"headline-container"},[n.$title=R("h3"),n.$close=R("span",{className:"modal-close material-icons-round",$click:n.close.bind((0,s.Z)(n))},["close"])]),n.$body=R("div",{className:"body-container"})]),n.parent.append(n.$main),n.jqMain=et()(n.$main),n.resize(),n}return(0,o.Z)(l,[{key:"resize",value:function(){this.$body.style.maxHeight="calc(".concat(this.parent.clientHeight,"px - 11rem)")}},{key:"isOpen",get:function(){return this.state.show}},{key:"open",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isAnimating||this.setState({show:e})}},{key:"close",value:function(){this.open(!1)}},{key:"toggle",value:function(){this.open(!this.state.show)}},{key:"render",value:function(e){var t=this,n=e.show;if(n!==this.state.show){this.isAnimating=!0;var r=n?"show":"hide";this.jqMain[r]({duration:"fast",complete:function(){t.isAnimating=!1}})}}}]),l}(function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(e){var t;return(0,a.Z)(this,i),(t=r.call(this)).state=e,t.pendingStateUpdates=[],t.renderTimeout=null,t.renderPromise=Promise.resolve(),t}return(0,o.Z)(i,[{key:"setState",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n="function"==typeof t?t:function(){return t};this.pendingStateUpdates.push(n),this.renderTimeout||(this.renderPromise=new Promise((function(t){e.renderTimeout=setTimeout((function(){var n=e.squashStateUpdates();e.render(n),e.state=n,e.renderTimeout=null,e.renderPromise=Promise.resolve(),e.emit("updated",n),t()}))})))}},{key:"update",value:function(){return this.renderPromise}},{key:"squashStateUpdates",value:function(){var e,t=Object.assign({},this.state),n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.pendingStateUpdates);try{for(n.s();!(e=n.n()).done;){var r=e.value;Object.assign(t,r(t))}}catch(e){n.e(e)}finally{n.f()}return this.pendingStateUpdates=[],t}},{key:"render",value:function(e){}}]),i}(ae()));function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function at(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ot(e,t){return b(e,Object.fromEntries(Object.entries(t).map((function(e){var t,n=(0,r.Z)(e,2);return[n[0],null!==(t=n[1][0])&&void 0!==t?t:""]}))))}function st(e,t,n,i){var a=e.generateUrl(n),o=at(at({},t),{},{host:["".concat(location.protocol,"//").concat(location.host)],url:[a.toString()]}),s=0;"number"==typeof n?s=n:null!==n&&(s=n.startTime);for(var l=fe(s,i),u=0,c=Object.entries(l);u<c.length;u++){var d=(0,r.Z)(c[u],2),h=d[0],f=d[1];o[h]=[f]}return o}var lt=function(){function e(t){(0,a.Z)(this,e),this.env=t}return(0,o.Z)(e,[{key:"generateUrl",value:function(e){return"number"==typeof e?this.generateTimecodeUrl(e):this.generateTimerangeUrl(e)}},{key:"generateTimerangeUrl",value:function(e){var t=[];null!==e&&(null!==e.endTime&&e.endTime>e.startTime&&t.unshift(e.endTime),(e.startTime>0||t.length>0)&&t.unshift(e.startTime));var n=this.env.getLocation();return t.length>0?n.searchParams.set("timecode",t.map((function(e){return e.toString()})).join(",")):n.searchParams.delete("timecode"),n}},{key:"generateTimecodeUrl",value:function(e){var t=null===e?null:{startTime:e,endTime:null};return this.generateTimerangeUrl(t)}}]),e}();function ut(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ct(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var dt=["current-time","marker","begin"],ht=function(e){(0,u.Z)(m,e);var t,n,i,f,p=(i=m,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,d.Z)(i);if(f){var n=(0,d.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function m(e,t,n){var r,i;(0,a.Z)(this,m),(i=p.call(this,e,{metadata:{},timing:{currentTime:0,markerRange:null},fps:0,startAtMode:"current-time",showQrCode:!1})).lastRenderedUrl=null,i.handlers={handleClickShareButton:i.handleClickShareButton.bind((0,s.Z)(i)),handleChangeStartAt:i.handleChangeStartAt.bind((0,s.Z)(i))},i.env=t,i.gen=new lt(i.env),i.$main.classList.add("bookmark-modal"),i.$title.innerText=i.env.t("modal.bookmark.title");var o=i.env.mkid(),l=(null!==(r=n.shareButtons)&&void 0!==r?r:[]).map((function(e){return function(e,t,n){var r,i;switch(t.type){case"material":i=R("i",{className:"dlf-share-button material-icons-round"},[t.icon]);break;case"image":i=R("img",{className:"dlf-share-button",src:t.src})}var a=R("a",{title:e.t(null!==(r=t.titleTranslationKey)&&void 0!==r?r:"",{},(function(){return""})),target:"_blank",rel:"noopener noreferrer",$click:n.onClick},[i]);return{hrefTemplate:t.hrefTemplate,setFullUrl:function(e){a.href=b(t.hrefTemplate,e)},element:a}}(i.env,e,{onClick:i.handlers.handleClickShareButton})}));return i.shareButtons=j(l),i.$startAtVariants={begin:i.makeStartAtVariant(o,"begin"),"current-time":i.makeStartAtVariant(o,"current-time"),marker:i.makeStartAtVariant(o,"marker")},i.$body.append(R("div",{},[i.shareButtons.length>0&&R("div",{className:"share-buttons"},i.shareButtons.map((function(e){return e.element}))),R("div",{className:"url-line"},[i.$urlInput=R("input",{type:"url",readOnly:!0,value:location.href}),i.$copyLinkBtn=R("a",{href:"javascript:void(0)",target:"_blank",className:"copy-to-clipboard",title:i.env.t("modal.bookmark.copy-link"),$click:i.handleCopyToClipboard.bind((0,s.Z)(i))},[R("i",{className:"material-icons-round"},["content_copy"])])]),i.$startAt=R("div",{className:"start-at"},dt.map((function(e){return i.$startAtVariants[e].$container}))),i.$qrCanvasContainer=R("div",{className:"url-qrcode"},[R("hr"),i.$qrCanvas=R("canvas")])])),i}return(0,o.Z)(m,[{key:"makeStartAtVariant",value:function(e,t){var n=this.env.mkid(),r=R("input",{type:"radio",name:e,value:t,id:n,$change:this.handlers.handleChangeStartAt}),i=R("label",{htmlFor:n},[this.translateStartAtLabel(t,{currentTime:0,markerRange:null},null)]);return{id:n,$radio:r,$label:i,$container:R("div",{className:"start-at-".concat(t)},[r,i])}}},{key:"handleClickShareButton",value:function(e){"dlf:qr_code"===e.currentTarget.href&&(e.preventDefault(),this.setState({showQrCode:!0}))}},{key:"handleCopyToClipboard",value:(n=(0,h.Z)(v().mark((function e(t){var n;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=this.generateUrl(this.state),this.$urlInput.focus(),navigator.clipboard?navigator.clipboard.writeText(n):document.execCommand("copy");case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"handleChangeStartAt",value:function(e){e.target instanceof HTMLInputElement&&this.setState({startAtMode:e.target.value})}},{key:"generateUrl",value:function(e){var t=this.getActiveTimeRange(e);return this.gen.generateTimerangeUrl(t).toString()}},{key:"getActiveTimeRange",value:function(e){switch(this.getStartAtMode(e)){case"begin":return null;case"current-time":return{startTime:e.timing.currentTime,endTime:null};case"marker":return e.timing.markerRange}}},{key:"open",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,l.Z)((0,d.Z)(m.prototype),"open",this).call(this,e),e||this.setState({showQrCode:!1})}},{key:"render",value:function(e){var t,n;(0,l.Z)((0,d.Z)(m.prototype),"render",this).call(this,e);var i=e.show,a=e.metadata,o=e.timing,s=e.fps,u=e.showQrCode,c=this.getStartAtMode(e),h=this.getActiveTimeRange(e),f=st(this.gen,a,h,s),v=null!==(t=null===(n=f.url)||void 0===n?void 0:n[0])&&void 0!==t?t:"",p=v!==this.lastRenderedUrl;if(p){for(var y={},g=0,b=Object.entries(f);g<b.length;g++){var k,w=(0,r.Z)(b[g],2),S=w[0],T=w[1];y[S]=encodeURIComponent(null!==(k=T[0])&&void 0!==k?k:"")}var P,x=ut(this.shareButtons);try{for(x.s();!(P=x.n()).done;)P.value.setFullUrl(y)}catch(e){x.e(e)}finally{x.f()}this.$urlInput.value=v,this.$copyLinkBtn.href=v,this.lastRenderedUrl=v}(p||u!==this.state.showQrCode)&&this.renderQrCode(u?v:null),this.$startAtVariants[c].$radio.checked=!0;var C,A=0,O=ut(dt);try{for(O.s();!(C=O.n()).done;){var _=C.value;this.$startAtVariants[_].$label.innerText=this.translateStartAtLabel(_,o,s);var M=this.isStartAtModeAllowed(_,e);Z(this.$startAtVariants[_].$container,"shown",M),M&&A++}}catch(e){O.e(e)}finally{O.f()}Z(this.$startAtVariants.begin.$container,"shown",A>1),i&&i!==this.state.show&&this.$urlInput.select()}},{key:"translateStartAtLabel",value:function(e,t,n){var r={currentTime:he(t.currentTime,!0,n),markerStart:"?",markerEnd:"_"};return null!==t.markerRange&&(r.markerStart=he(t.markerRange.startTime,!0,n),null!==t.markerRange.endTime&&(r.markerEnd=he(t.markerRange.endTime,!0,n))),this.env.t("modal.bookmark.start-at-".concat(e),r)}},{key:"getStartAtMode",value:function(e){return this.isStartAtModeAllowed(e.startAtMode,e)?e.startAtMode:"begin"}},{key:"isStartAtModeAllowed",value:function(e,t){switch(e){case"begin":return!0;case"current-time":return 0!==t.timing.currentTime;case"marker":return null!==t.timing.markerRange}}},{key:"renderQrCode",value:(t=(0,h.Z)(v().mark((function e(t){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t){e.next=13;break}return e.prev=1,e.next=4,Qe.toCanvas(this.$qrCanvas,t);case 4:this.$qrCanvasContainer.classList.add("dlf-visible"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),alert(this.env.t("error.qrcode")),console.error(e.t0);case 11:e.next=14;break;case 13:this.$qrCanvasContainer.classList.remove("dlf-visible");case 14:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(e){return t.apply(this,arguments)})}]),m}(rt);function ft(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pt(e,t,n){var r=n?".mod":"";return e.t("key.".concat(t).concat(r),{},(function(){return e.t("key.".concat(t),{},(function(){return e.t("key.generic".concat(r),{key:t.toUpperCase()},(function(){return e.t("key.generic",{key:t.toUpperCase()})}))}))}))}function mt(e,t){var n=function(e){var t,n=[],r=null,i=I(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;null===r?r={begin:a,end:a}:a.charCodeAt(0)===r.end.charCodeAt(0)+1?r.end=a:(n.push(r),r={begin:a,end:a})}}catch(e){i.e(e)}finally{i.f()}return null!==r&&n.push(r),n}(t.keys),r=[],i=[];void 0!==t.mod&&i.push(t.mod),"Shift"!==t.mod&&t.keys.every((function(e){return/^[A-Z]$/.test(e)}))&&i.push("Shift");var a,o=i.length>0||n.length>1,s=e.t("key.unto".concat(o?".mod":"")),l=ft(n);try{for(l.s();!(a=l.n()).done;){var u=a.value,c=R("kbd",{},[pt(e,u.begin,o)]);if(u.begin===u.end)r.push(c);else{var d=R("kbd",{},[pt(e,u.end,o)]);r.push(R("span",{className:"kb-range"},[c,s,d]))}}}catch(e){l.e(e)}finally{l.f()}var h=[];if(i.length>0){var f,v,p=e.getKeyboardVariant(),m=ft(i);try{for(m.s();!(v=m.n()).done;){var y=v.value,g=R("kbd",{},[e.t("key.mod.".concat(p,".").concat(y))]);h.push(g," + ")}}catch(e){m.e(e)}finally{m.f()}(f=h).push.apply(f,(0,re.Z)(E(r,"/")))}else h=E(r," / ");return t.repeat&&(h=E(e.t("key.repeat",{key:"###"}).split("###"),h)),R("span",{},h)}function yt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bt=function(e){(0,u.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function s(e,t,n){var r;return(0,a.Z)(this,s),(r=i.call(this,e,{})).env=t,r.config=n,r.tableSections=[],r.createBodyDom(),r.updateRowVisibility(),r}return(0,o.Z)(s,[{key:"open",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&this.updateRowVisibility(),(0,l.Z)((0,d.Z)(s.prototype),"open",this).call(this,e)}},{key:"createBodyDom",value:function(){var e=this.env;this.$main.classList.add("help-modal"),this.$title.innerText=e.t("modal.help.title");for(var t=R("table",{className:"keybindings-table"}),n=function(e,t){var n=e.getKeyboardVariant(),r={navigate:{},player:{},sound_tools:{},other:{}},i=t.slice();i.sort((function(e,t){return e.order-t.order}));var a,o=yt(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(null==s.keyboard||s.keyboard===n){var l=r[s.kind];l||(l=r[s.kind]={});var u=l[s.action];u||(u=l[s.action]=[]),u.push(s)}}}catch(e){o.e(e)}finally{o.f()}return r}(e,this.config.keybindings),i=0,a=Object.entries(n);i<a.length;i++){var o=(0,r.Z)(a[i],2),s=o[0],l=o[1],u=(0,re.Z)(Object.entries(l));if(0!==u.length){var c,d={thead:R("thead",{},[R("th",{className:"kb-group",colSpan:2},[e.t("action.kind.".concat(s))])]),tbody:R("tbody",{}),rows:[]},h=yt(u);try{for(h.s();!(c=h.n()).done;){var f=(0,r.Z)(c.value,2),v=f[0],p=f[1],m=R("tr",{},[R("td",{className:"key"},this.listKeybindings(p)),R("td",{className:"action"},[this.describeAction(v)])]);d.rows.push({action:v,tr:m}),d.tbody.append(m)}}catch(e){h.e(e)}finally{h.f()}t.append(d.thead,d.tbody),this.tableSections.push(d)}}this.$body.append(t)}},{key:"listKeybindings",value:function(e){var t=this;return E(e.map((function(e){return mt(t.env,e)})),R("br"))}},{key:"describeAction",value:function(e){return this.env.t("action.".concat(e),this.config.constants)}},{key:"updateRowVisibility",value:function(){var e,t=yt(this.tableSections);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,i=!1,a=yt(r.rows);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=this.config.actionIsAvailable(o.action);o.tr.setAttribute("aria-disabled",s?"false":"true");var l=s?"":this.env.t("action.unavailable");o.tr.setAttribute("title",l),o.tr.setAttribute("aria-label",l),i||(i=s)}}catch(e){a.e(e)}finally{a.f()}r.thead.setAttribute("aria-disabled",i?"false":"true"),r.tbody.setAttribute("aria-disabled",i?"false":"true")}}catch(e){t.e(e)}finally{t.f()}}}]),s}(rt),kt=n(8),wt=n.n(kt),St=function(){function e(t){(0,a.Z)(this,e),this.jpeg=t,this.exif=wt().load(t)}return(0,o.Z)(e,[{key:"toBinaryString",value:function(){var e=wt().dump(this.exif);return wt().insert(e,this.jpeg)}},{key:"addMetadata",value:function(e){e.title&&(this.exif["0th"][wt().ImageIFD.ImageDescription]=e.title),e.comment&&(this.exif.Exif[wt().ExifIFD.UserComment]=e.comment)}},{key:"getMetadata",value:function(){var e,t;return{title:null!==(e=this.exif["0th"][wt().ImageIFD.ImageDescription])&&void 0!==e?e:"",comment:null!==(t=this.exif.Exif[wt().ExifIFD.UserComment])&&void 0!==t?t:""}}}],[{key:"fromBinaryString",value:function(t){return new e(t)}}]),e}();function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pt=String.fromCharCode(137,80,78,71,13,10,26,10),xt=function(){function e(t,n){(0,a.Z)(this,e),this.headerChunk=t,this.chunks=n}return(0,o.Z)(e,[{key:"addChunk",value:function(t){var n=e.createChunk(t);if("iTXt"!==n.type)throw new Error("Adding chunk type ".concat(n.type," is not supported."));this.chunks.unshift(n)}},{key:"toBinaryString",value:function(){var t=Pt,n=function(e){var n="";n+=Ct(e.size,4),n+=e.type,n+=e.data,n+=Ct(e.crc,4),t+=n};n(this.headerChunk);var r,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.chunks);try{for(i.s();!(r=i.n()).done;)n(r.value)}catch(e){i.e(e)}finally{i.f()}return n(e.createChunk({type:"IEND"})),t}},{key:"addMetadata",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var i=(0,r.Z)(n[t],2),a=i[0],o=i[1];if(o){var s={title:"Title",comment:"Comment"}[a];s&&this.addChunk({type:"iTXt",keyword:s,text:o})}}}}],[{key:"createChunk",value:function(e){var t={};switch(e.type){case"raw":t.type=e.rawType,t.data=e.rawData;break;case"iTXt":t.type="iTXt",t.data="".concat(e.keyword.replace(/\0/g,""),"\0\0\0\0\0").concat(e.text);break;case"IEND":t.type="IEND",t.data=""}return t.size=t.data.length,t.crc=function(e){for(var t=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],n=-1,r=0;r<e.length;r++)n=n>>>8^t[255&(n^e.charCodeAt(r))];return(-1^n)>>>0}(t.type+t.data),t}},{key:"fromBinaryString",value:function(t){if(function(e){return e.substr(0,8)===Pt}(t.substr(0,8))){var n;t=t.substr(8);for(var r=[];""!==t;){var i={},a=At(t.substr(0,4));a<0&&(a=0);var o=t.substr(0,a+12);t=t.substr(a+12),i.size=a,i.type=o.substr(4,4),i.data=o.substr(8,a),i.crc=At(o.substr(8+a,4)),"IHDR"===i.type?n=i:"IEND"!==i.type&&r.push(i)}return void 0===n?void 0:new e(n,r)}}}]),e}();function Ct(e,t){for(var n=new Array(t),r=t-1;r>=0;r--)n[r]=String.fromCharCode(255&e),e>>=8;return n.join("")}function At(e){for(var t=0,n=0;n<e.length;n++)t<<=8,t|=255&e.charCodeAt(n);return t}const Ot=[{mimeType:"image/png",extension:"png",label:"PNG",parseBinaryString:function(e){return xt.fromBinaryString(e)}},{mimeType:"image/jpeg",extension:"jpg",label:"JPEG",parseBinaryString:function(e){return St.fromBinaryString(e)}},{mimeType:"image/tiff",extension:"tiff",label:"TIFF",parseBinaryString:function(){}}];function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rt=function(e){(0,u.Z)(g,e);var t,n,i,f,p,m,y=(p=g,m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,d.Z)(p);if(m){var n=(0,d.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function g(e,t,n){var r,i;(0,a.Z)(this,g);var o=Ot.filter((function(e){return t.supportsCanvasExport(e.mimeType)}));(i=y.call(this,e,{metadata:null,showMetadata:!0,fps:null,timecode:null,supportedImageFormats:o,selectedImageFormat:null!==(r=o[0])&&void 0!==r?r:null})).env=t,i.gen=new lt(t),i.videoDomElement=null,i.config=n,i.constants=N(n.constants,{screenshotFilenameTemplate:"Screenshot",screenshotCommentTemplate:""});var l=i.config.keybindings.find((function(e){return"modal.screenshot.snap"===e.action}));i.$main.classList.add("screenshot-modal"),i.$title.innerText=t.t("modal.screenshot.title");var u=t.mkid(),c=t.mkid();return i.$body.append(R("div",{className:"screenshot-config"},[R("h4",{},[t.t("modal.screenshot.configuration")]),R("section",{className:"metadata-config"},[R("h1",{},[t.t("modal.screenshot.metadata")]),R("div",{className:"metadata-overlay"},[R("input",{type:"checkbox",id:u,checked:i.state.showMetadata,$change:i.handleChangeShowMetadata.bind((0,s.Z)(i))}),R("label",{htmlFor:u},[t.t("modal.screenshot.metadata-overlay")])])]),R("section",{},[R("h1",{},[t.t("modal.screenshot.file-format")]),R("div",{},i.state.supportedImageFormats.map((function(e){var n,r=t.mkid();return R("span",{className:"file-format-option"},[R("input",{id:r,name:c,type:"radio",checked:e.mimeType===(null===(n=i.state.selectedImageFormat)||void 0===n?void 0:n.mimeType),$change:function(){i.setState({selectedImageFormat:e})}}),R("label",{htmlFor:r},[" ".concat(e.label)])])})))]),R("a",{href:"#",className:"download-link",$click:i.handleDownloadImage.bind((0,s.Z)(i))},[R("i",{className:"material-icons-round inline-icon"},["download"]),t.t("modal.screenshot.download-image")]),l&&R("aside",{className:"snap-tip"},[R("i",{className:"material-icons-round inline-icon"},["info_outline"]),R("span",{},E(t.t("modal.screenshot.snap-tip",{keybinding:"{kb}"}).split("{kb}"),mt(t,l)))])]),i.$canvas=R("canvas")),i}return(0,o.Z)(g,[{key:"setVideo",value:function(e){return this.videoDomElement=e,this}},{key:"setMetadata",value:function(e){return this.setState({metadata:e}),this}},{key:"setFps",value:function(e){return this.setState({fps:e}),this}},{key:"setTimecode",value:function(e){return this.setState({timecode:e}),this}},{key:"handleChangeShowMetadata",value:function(e){e.target instanceof HTMLInputElement&&this.setState({showMetadata:e.target.checked})}},{key:"handleDownloadImage",value:(f=(0,h.Z)(v().mark((function e(t){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,this.downloadCurrentImage(this.state);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"renderCurrentScreenshot",value:function(e){var t=e.showMetadata,n=e.metadata,i=e.timecode,a=e.fps;if(null===this.videoDomElement)return!1;var o={captions:[],minWidth:1e3};if(t){var s=st(this.gen,null!=n?n:{},i,a);o.captions=this.getCaptions(s)}return function(e,t,n){var i,a,o=e instanceof HTMLCanvasElement?[e,e.getContext("2d")]:[e.canvas,e],s=(0,r.Z)(o,2),l=s[0],u=s[1];if(null===u)return!1;var c=Math.max(1,Math.ceil((null!==(i=n.minWidth)&&void 0!==i?i:0)/t.videoWidth));l.width=t.videoWidth*c,l.height=t.videoHeight*c,u.drawImage(t,0,0,l.width,l.height);var d=l.height/1080,h=10*d;u.font="".concat(Math.floor(25*d),"px Arial"),u.fillStyle="#FFFFFF",u.shadowBlur=5,u.shadowColor="black";var f,v=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_t(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(null!==(a=n.captions)&&void 0!==a?a:[]);try{for(v.s();!(f=v.n()).done;){var p=f.value,m="left"===p.h?h:l.width-h,y="top"===p.v?h:l.height-h;u.textAlign=p.h,u.fillText(p.text,m,y)}}catch(e){v.e(e)}finally{v.f()}}(this.$canvas,this.videoDomElement,o),!0}},{key:"downloadCurrentImage",value:(i=(0,h.Z)(v().mark((function e(t){var n,r,i,a,o,s,l;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.metadata,r=t.timecode,i=t.fps,a=t.selectedImageFormat,null!==n&&null!==r&&null!==a){e.next=4;break}return console.error("one of [metadata, timecode, selectedImageFormat] is null"),e.abrupt("return",!1);case 4:return o=st(this.gen,n,r,i),e.next=7,this.makeImageBlob(this.$canvas,a,o);case 7:return s=e.sent,l=this.getFilename(n,a),C(s,l),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"makeImageBlob",value:(n=(0,h.Z)(v().mark((function e(t,n,r){var i,a,o,s,l,u;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t,n.mimeType);case 2:return i=e.sent,e.next=5,T(i,"readAsBinaryString");case 5:if(a=e.sent,!(o=n.parseBinaryString(a))){e.next=13;break}return o.addMetadata({title:null!==(s=null===(l=r.title)||void 0===l?void 0:l[0])&&void 0!==s?s:"",comment:ot(this.constants.screenshotCommentTemplate,r)}),u=O(o.toBinaryString()),e.abrupt("return",new Blob([u],{type:i.type}));case 13:return e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"getFilename",value:function(e,t){var n,r,i=ot(this.constants.screenshotFilenameTemplate,e),a=t.extension;return"".concat((n=i,r=n.replace(/[^a-zA-Z0-9()]+/g,"_"),r.length>0?r:"_"),".").concat(a)}},{key:"getCaptions",value:function(e){return this.config.screnshotCaptions.map((function(t){return Et(Et({},t),{},{text:ot(t.text,e)})}))}},{key:"snap",value:(t=(0,h.Z)(v().mark((function e(){var t;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update();case 2:if(t=this.state,e.t0=this.renderCurrentScreenshot(t),!e.t0){e.next=8;break}return e.next=7,this.downloadCurrentImage(t);case 7:e.t0=e.sent;case 8:e.t0||alert(this.env.t("modal.screenshot.error"));case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(e){(0,l.Z)((0,d.Z)(g.prototype),"render",this).call(this,e),e.show&&(!this.state.show||e.showMetadata!==this.state.showMetadata)&&this.renderCurrentScreenshot(e)}}]),g}(rt);const Zt=JSON.parse('[{"keys":["Escape"],"action":"cancel","kind":"other","order":100},{"keys":["?"],"repeat":false,"action":"modal.help.toggle","kind":"other","order":99},{"keys":["F1"],"repeat":false,"action":"modal.help.toggle","kind":"other","order":99},{"keys":["b"],"scope":"player","action":"modal.bookmark.open","kind":"other","order":30},{"keys":["s"],"scope":"player","action":"modal.screenshot.open","kind":"other","order":31},{"keys":["S"],"scope":"player","action":"modal.screenshot.snap","kind":"other","order":32},{"keys":["f"],"repeat":false,"scope":"player","action":"fullscreen.toggle","kind":"player","order":20},{"keys":["t"],"repeat":false,"scope":"player","action":"theater.toggle","kind":"player","order":21},{"keys":[" "],"repeat":false,"scope":"player","action":"playback.toggle","kind":"player","order":0},{"keys":["m"],"repeat":false,"scope":"player","action":"playback.volume.mute.toggle","kind":"player","order":12},{"keys":["ArrowUp"],"scope":"player","action":"playback.volume.inc","kind":"player","order":10},{"keys":["ArrowDown"],"scope":"player","action":"playback.volume.dec","kind":"player","order":11},{"keys":["c"],"repeat":false,"scope":"player","action":"playback.captions.toggle","kind":"player","order":13},{"keys":["ArrowLeft"],"repeat":false,"scope":"player","action":"navigate.rewind","kind":"navigate","order":0},{"keys":["ArrowRight"],"repeat":false,"scope":"player","action":"navigate.seek","kind":"navigate","order":1},{"keys":["ArrowLeft"],"repeat":true,"scope":"player","action":"navigate.continuous-rewind","kind":"navigate","order":2},{"keys":["ArrowRight"],"repeat":true,"scope":"player","action":"navigate.continuous-seek","kind":"navigate","order":3},{"keyboard":"ibm","mod":"Ctrl","keys":["ArrowLeft"],"scope":"player","action":"navigate.chapter.prev","kind":"navigate","order":10},{"keyboard":"mac","mod":"Alt","keys":["ArrowLeft"],"scope":"player","action":"navigate.chapter.prev","kind":"navigate","order":10},{"keyboard":"ibm","mod":"Ctrl","keys":["ArrowRight"],"scope":"player","action":"navigate.chapter.next","kind":"navigate","order":11},{"keyboard":"mac","mod":"Alt","keys":["ArrowRight"],"scope":"player","action":"navigate.chapter.next","kind":"navigate","order":11},{"keys":["0","1","2","3","4","5","6","7","8","9"],"scope":"player","action":"navigate.position.percental","kind":"navigate","order":25},{"mod":"Shift","keys":["ArrowLeft"],"scope":"player","action":"navigate.frame.prev","kind":"navigate","order":20},{"mod":"Shift","keys":["ArrowRight"],"scope":"player","action":"navigate.frame.next","kind":"navigate","order":21},{"keys":[","],"scope":"player","action":"navigate.frame.prev","kind":"navigate","order":20},{"keys":["."],"scope":"player","action":"navigate.frame.next","kind":"navigate","order":21},{"keys":["Shift"],"scope":"player","action":"navigate.thumbnails.snap","kind":"navigate","order":30,"keydown":true,"keyup":true},{"keys":["F2"],"repeat":false,"action":"sound_tools.mode.audio","kind":"sound_tools","order":0},{"keys":["F4"],"repeat":false,"action":"sound_tools.mode.video","kind":"sound_tools","order":1},{"keys":["<"],"scope":"player","action":"sound_tools.segments.add","kind":"sound_tools","order":2},{"keys":[">"],"scope":"player","action":"sound_tools.segments.close","kind":"sound_tools","order":3},{"keys":["w"],"repeat":false,"scope":"player","action":"sound_tools.waveform.toggle","kind":"sound_tools","order":4}]');function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $t=function(e){(0,u.Z)(f,e);var t,n,i=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function f(){var e;return(0,a.Z)(this,f),(e=i.call(this)).metadata={},e.keybindings=Zt,e.handlers={onKeyDown:e.onKeyDown.bind((0,s.Z)(e)),onKeyUp:e.onKeyUp.bind((0,s.Z)(e)),onClickChapterLink:e.onClickChapterLink.bind((0,s.Z)(e)),onChapterChanged:e.onChapterChanged.bind((0,s.Z)(e)),onCloseModal:e.onCloseModal.bind((0,s.Z)(e))},e.chapterLinks=[],e.pageSelect=null,e.modals=null,e}return(0,o.Z)(f,[{key:"getKeybindings",value:function(){return this.keybindings}},{key:"connectedCallback",value:function(){var e,t=this;if(!this.hasBeenConnected_){(0,l.Z)((0,d.Z)(f.prototype),"connectedCallback",this).call(this),this.eventMgr_.record((function(){t.addEventListener("chapterchange",t.handlers.onChapterChanged)}));var n,r,i,a=this.getConfig(),o=N(null!==(e=a.constants)&&void 0!==e?e:{},this.constants);null!==this.playerView&&(this.modals=function(e,t){var n=Object.values(t),r=document.createElement("div");r.className="sxnd-modal-cover",r.addEventListener("click",(function(){o.closeAll()})),document.body.append(r);var i,a={toggleExclusive:function(e){e.isOpen?e.close():o.hasOpen()||e.open()},setFullscreen:function(e){(null!=e?e:document.body).append(r)},hasOpen:function(){return n.some((function(e){return e.isOpen}))},closeNext:function(){var e,t=Xe(n);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(r.isOpen){r.close();break}}}catch(e){t.e(e)}finally{t.f()}},closeAll:function(){var e,t=Xe(n);try{for(t.s();!(e=t.n()).done;)e.value.close()}catch(e){t.e(e)}finally{t.f()}},update:(i=(0,h.Z)(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return e.update()})));case 2:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),resize:function(){var e,t=Xe(n);try{for(t.s();!(e=t.n()).done;)e.value.resize()}catch(e){t.e(e)}finally{t.f()}}},o=Object.assign(new(ae()),t,a);e.record((function(){window.addEventListener("resize",(function(){o.resize()})),document.addEventListener("fullscreenchange",(function(){o.setFullscreen(document.fullscreenElement)}))}));for(var s=function(){var e=u[l];e.on("updated",(function(){e.isOpen||o.emit("closed",e),o.hasOpen()?r.classList.add("shown"):r.classList.remove("shown")}))},l=0,u=n;l<u.length;l++)s();return o}(this.eventMgr_,{help:new bt(this.playerView,this.env,{constants:Bt(Bt({},o),{},{forceLandscapeOnFullscreen:Number(this.constants.forceLandscapeOnFullscreen)}),keybindings:this.keybindings,actionIsAvailable:function(e){var n=t.actions[e];return void 0!==n&&n.isAvailable()}}),bookmark:new ht(this.playerView,this.env,{shareButtons:null!==(n=a.shareButtons)&&void 0!==n?n:[]}),screenshot:new Rt(this.playerView,this.env,{keybindings:this.keybindings,screnshotCaptions:null!==(r=a.screenshotCaptions)&&void 0!==r?r:[],constants:null!==(i=a.constants)&&void 0!==i?i:{}})}),this.modals.on("closed",this.handlers.onCloseModal)),setTimeout((function(){t.loadMetadata()}))}}},{key:"loadMetadata",value:function(){var e=this;this.querySelectorAll("dlf-meta").forEach((function(t){var n=t.getAttribute("key"),r=t.getAttribute("value");if(n&&r){var i=e.metadata[n];void 0===i&&(i=e.metadata[n]=[]),i.push(r)}else console.warn("Ignoring invalid <dlf-meta>")}))}},{key:"getActions",value:function(){var e=this;return Bt(Bt({},(0,l.Z)((0,d.Z)(f.prototype),"getActions",this).call(this)),{},{cancel:X((function(){var t;if(null===(t=e.modals)||void 0===t||!t.hasOpen())return e.ui.handleEscape();e.modals.closeNext()})),"modal.help.open":X((function(){var t;e.openModal(null===(t=e.modals)||void 0===t?void 0:t.help)})),"modal.help.toggle":X((function(){var t;null!==e.modals&&(null===(t=e.ui.seekBar)||void 0===t||t.endSeek(),e.modals.toggleExclusive(e.modals.help))})),"modal.bookmark.open":X((function(){e.showBookmarkUrl()})),"modal.screenshot.open":X({isAvailable:function(){return!e.isAudioOnly()},execute:function(){e.showScreenshot()}}),"modal.screenshot.snap":X({isAvailable:function(){return!e.isAudioOnly()},execute:function(){e.snapScreenshot()}}),"theater.toggle":X((function(){var t;null===(t=e.ui.seekBar)||void 0===t||t.endSeek();var n=new CustomEvent("dlf-theater-mode",{detail:{action:"toggle",persist:!0}});window.dispatchEvent(n)}))})}},{key:"getTimeRange",value:function(){var e=(0,l.Z)((0,d.Z)(f.prototype),"getTimeRange",this).call(this);if(null!==e)return e;var t=this.env.getLocation().searchParams.get("timecode");if(t){var n=t.split(",",2),i=(0,r.Z)(n,2),a=i[0],o=i[1];return this.parseTimeRange(a,o)}return null}},{key:"getChapterLink",value:function(e){var t=e.getAttribute("data-timecode");if(null!==t){var n=Number(t);if(Number.isFinite(n))return{timecode:n,fileIds:[],title:"",pageNo:null}}var r=e.hash.match(/timecode=(\d+(?:\.\d?)?)(?:;fileIds=([a-zA-Z0-9_,]+))?/);if(null!==r){var i=Number(r[1]);if(Number.isFinite(i)){var a=r[2];return{timecode:i,fileIds:void 0===a?[]:a.split(","),title:"",pageNo:null}}}return null}},{key:"onDomContentLoaded",value:function(){var e=this;(0,l.Z)((0,d.Z)(f.prototype),"onDomContentLoaded",this).call(this),document.querySelectorAll("a[data-timecode], .tx-dlf-tableofcontents a, .tx-dlf-toc a").forEach((function(t){var n=t,r=e.getChapterLink(n);if(null!==r){var i=t;i.dlfVideoLink=r,e.eventMgr_.record((function(){i.addEventListener("click",e.handlers.onClickChapterLink)})),e.chapterLinks.push(i)}}));var t=document.querySelector("li.pages form select");t instanceof HTMLSelectElement&&(this.pageSelect=t,this.pageSelect.onchange=function(n){var r,i,a,o=Number(t.value),s=null!==(r=e.chapters.find((function(e){return e.pageNo===o})))&&void 0!==r?r:e.chapters.at(o-1);void 0!==s&&e.seekToChapter(s)||null===(i=e.pageSelect)||void 0===i||null===(a=i.form)||void 0===a||a.submit()})}},{key:"loaded",value:function(){var e;(0,l.Z)((0,d.Z)(f.prototype),"loaded",this).call(this),null===(e=this.modals)||void 0===e||e.resize()}},{key:"configureFrontend",value:function(e){var t=this;(0,l.Z)((0,d.Z)(f.prototype),"configureFrontend",this).call(this,e),this.eventMgr_.record((function(){document.addEventListener("keydown",t.handlers.onKeyDown,{capture:!0}),document.addEventListener("keyup",t.handlers.onKeyUp,{capture:!0})}))}},{key:"getKeyboardScope",value:function(){var e;if(null!==(e=this.modals)&&void 0!==e&&e.hasOpen())return"modal";for(var t=0,n=Array.from(document.querySelectorAll("input:focus"));t<n.length;t++){var r=n[t];if(r instanceof HTMLElement&&null!==r.offsetParent)return"input"}return"player"}},{key:"onKeyDown",value:function(e){this.hasVideo&&this.handleKey(e,"down")}},{key:"onKeyUp",value:function(e){this.hasVideo&&(e.stopImmediatePropagation(),this.handleKey(e,"up"),this.cancelTrickPlay())}},{key:"handleKey",value:function(e,t){var n=this.getKeyboardScope(),r=function(e,t,n,r){var i,a=function(e){var t=$.None;return e.ctrlKey&&"Control"!==e.key&&(t|=$.Ctrl),e.metaKey&&"Meta"!==e.key&&(t|=$.Meta),e.shiftKey&&"Shift"!==e.key&&(t|=$.Shift),e.altKey&&"Alt"!==e.key&&(t|=$.Alt),t}(n),o=e.getKeyboardVariant(),s=I(t);try{for(s.s();!(i=s.n()).done;){var l,u=i.value,c=u.keys.findIndex((function(e){return e===n.key}));if(-1!==c&&!(null!=u.repeat&&u.repeat!==n.repeat||null!=u.scope&&u.scope!==r||q(e,n.key,$[null!==(l=u.mod)&&void 0!==l?l:"None"])!==q(e,n.key,a)||null!=u.keyboard&&u.keyboard!==o))return{keybinding:u,keyIndex:c}}}catch(e){s.e(e)}finally{s.f()}}(this.env,this.keybindings,e,n);if(r){var i,a,o=r.keybinding,s=r.keyIndex;e.preventDefault();var l="down"===t&&(null===(i=o.keydown)||void 0===i||i)||"up"===t&&null!==(a=o.keyup)&&void 0!==a&&a,u=this.actions[o.action];l&&void 0!==u&&u.isAvailable()&&!1!==u.execute(o,s,t)&&"Escape"===e.key&&e.stopImmediatePropagation()}}},{key:"onClickChapterLink",value:function(e){var t=e.currentTarget;this.seekToChapter(t.dlfVideoLink)&&(e.preventDefault(),this.media.play())}},{key:"onChapterChanged",value:function(e){var t=e.detail.curChapter;if(null!=this.pageSelect&&null!==t)if(null!==t.pageNo)this.pageSelect.value=t.pageNo.toString();else{var n=this.chapters.indexOf(t);void 0!==n&&(this.pageSelect.value=(n+1).toString())}var r,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return jt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.chapterLinks);try{for(i.s();!(r=i.n()).done;){var a=r.value;null!==a.parentElement&&Z(a.parentElement,"current",D.isEqual(a.dlfVideoLink,t))}}catch(e){i.e(e)}finally{i.f()}}},{key:"onCloseModal",value:function(e){this.resumeOn(e)}},{key:"showBookmarkUrl",value:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.hasCurrentData){var a=null===(e=this.modals)||void 0===e?void 0:e.bookmark;void 0!==a&&(a.setState({metadata:this.metadata,timing:{currentTime:this.displayTime,markerRange:null!==(t=null!=i?i:null===(n=this.getMarkers().activeSegment)||void 0===n?void 0:n.toTimeRange())&&void 0!==t?t:null},fps:null!==(r=this.getFps())&&void 0!==r?r:0}),null!==i&&a.setState({startAtMode:"marker"}),this.openModal(a,!0))}}},{key:"prepareScreenshot",value:function(){var e;if(this.hasCurrentData)return null===(e=this.modals)||void 0===e?void 0:e.screenshot.setVideo(this.video).setMetadata(this.metadata).setFps(this.getFps()).setTimecode(this.displayTime)}},{key:"showScreenshot",value:function(){var e=this.prepareScreenshot();this.openModal(e,!0)}},{key:"snapScreenshot",value:function(){var e=this.prepareScreenshot();null==e||e.snap()}},{key:"openModal",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null!=e&&(n&&this.pauseOn(e),null===(t=this.ui.seekBar)||void 0===t||t.endSeek(),e.open())}}]),f}(Ve);function qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ft(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}customElements.define("slub-media",$t);var Nt=function(e){(0,u.Z)(l,e);var t,n,i=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function l(){var e;return(0,a.Z)(this,l),(e=i.call(this)).rows={},e.rowCount=0,e.$container=null,e.markersHandlers={remove:function(t){var n,r=qt(t.detail.segments);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.removeRowById(i.id)}}catch(e){r.e(e)}finally{r.f()}},remove_all:function(){e.clearTable()},add:function(t){e.syncSegments(t.detail.segments)},update:function(t){var n=t.detail.segment;e.syncSegment(n)},activate_segment:function(t){for(var n=t.detail.segment,r=0,i=Object.values(e.rows);r<i.length;r++){var a=i[r];Z(a.$tr,"active-segment",null!==n&&a.segment.id===n.id)}}},e.handlers={onLabelEditKeydown:e.rowEvent(e.onLabelEditKeydown.bind((0,s.Z)(e))),onLabelEditInput:e.rowEvent(e.onLabelEditInput.bind((0,s.Z)(e))),onDeleteRow:e.rowEvent(e.onDeleteRow.bind((0,s.Z)(e))),onBookmarkRow:e.rowEvent(e.onBookmarkRow.bind((0,s.Z)(e))),onSeekToStartTime:e.rowEvent(e.onSeekToStartTime.bind((0,s.Z)(e))),onSeekToEndTime:e.rowEvent(e.onSeekToEndTime.bind((0,s.Z)(e))),onClear:e.onClear.bind((0,s.Z)(e)),onDownloadCsv:e.onDownloadCsv.bind((0,s.Z)(e))},e}return(0,o.Z)(l,[{key:"attachToPlayer",value:function(e){this.$container=R("div",{className:"dlf-media-markers is-empty"},[R("h2",{},[this.env.t("control.sound_tools.marker_table.title")]),R("div",{className:"dlf-media-markers-empty-msg",innerHTML:this.getEmptyTableHTML()}),R("div",{className:"dlf-media-markers-list"},[this.$exportCsvButton=R("a",{href:"#",$click:this.handlers.onDownloadCsv},[this.env.t("control.sound_tools.marker_table.download_csv")]),", ",this.$exportCsvButton=R("a",{href:"#",$click:this.handlers.onClear},[this.env.t("control.sound_tools.marker_table.clear")]),R("table",{},[R("thead",{},[R("tr",{},[R("th",{},[this.env.t("control.sound_tools.marker_table.entry.name")]),R("th",{},[this.env.t("control.sound_tools.marker_table.entry.startTime")]),R("th",{},[this.env.t("control.sound_tools.marker_table.entry.endTime")]),R("th",{},[""])])]),this.$body=R("tbody",{},[])])])]);for(var t=0,n=Object.entries(this.markersHandlers);t<n.length;t++){var i=(0,r.Z)(n[t],2),a=i[0],o=i[1];e.getMarkers().addEventListener(a,o)}this.syncSegments(e.getMarkers().getSegments()),this.append(this.$container)}},{key:"onLabelEditKeydown",value:function(e,t){"Enter"===t.key&&e.$labelEditBox.blur()}},{key:"onLabelEditInput",value:function(e,t){null!==this.player&&this.player.getMarkers().update({id:e.segment.id,labelText:e.$labelEditBox.value})}},{key:"onDeleteRow",value:function(e){null!==this.player&&this.player.getMarkers().removeById(e.segment.id)}},{key:"onBookmarkRow",value:function(e){this.player instanceof $t&&this.player.showBookmarkUrl(e.segment.toTimeRange())}},{key:"onSeekToStartTime",value:function(e){null!==this.player&&(this.player.seekTo(e.segment.startTime),this.player.getMarkers().activateSegmentById(e.segment.id))}},{key:"onSeekToEndTime",value:function(e){var t;null!==this.player&&(this.player.seekTo(null!==(t=e.segment.endTime)&&void 0!==t?t:e.segment.startTime),this.player.getMarkers().activateSegmentById(e.segment.id))}},{key:"onClear",value:function(e){e.preventDefault(),null!==this.player&&confirm(this.env.t("control.sound_tools.marker_table.clear.confirm"))&&this.player.getMarkers().removeAll()}},{key:"onDownloadCsv",value:function(e){e.preventDefault();var t=new lt(this.env),n=[["ID","Label","Start [s]","End [s]","URL"]].concat((0,re.Z)(Object.values(this.rows).map((function(e){var n,r;return[e.segment.id,e.segment.labelText,e.segment.startTime.toString(),null!==(n=null===(r=e.segment.endTime)||void 0===r?void 0:r.toString())&&void 0!==n?n:"",t.generateTimerangeUrl(e.segment.toTimeRange()).toString()]})))).map((function(e){return e.map((function(e){return'"'.concat(e.replace(/"/g,'""'),'"')})).join(";")})).join("\n");C(new Blob([n],{type:"text/csv"}),"markers.csv")}},{key:"rowEvent",value:function(e){var t=this;return function(n){var r=n.currentTarget;if(void 0!==r.rowId){var i=t.rows[r.rowId];void 0!==i&&e(i,n)}}}},{key:"syncSegments",value:function(e){var t,n=qt(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.syncSegment(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"syncSegment",value:function(e){var t=!1,n=this.rows[e.id];void 0===n&&(n=this.rows[e.id]=this.createRow(e),t=!0,this.rowCount++);var r=Object.assign({},n.segment);Object.assign(n.segment,e),(t||0!==this.cmpSegment(e,r))&&this.insertRow(n),n.$labelEditBox.value=e.labelText,n.$labelEditBox.readOnly=!e.editable,n.$startTime.textContent=he(e.startTime,!0),n.$endTime.textContent=void 0===e.endTime?"":he(e.endTime,!0),this.update()}},{key:"createRow",value:function(e){var t,n,r,i,a=R("button",{title:this.env.t("control.sound_tools.marker_table.entry.delete"),$click:this.handlers.onDeleteRow},[R("span",{className:"material-icons-round inline-icon"},["delete"])]);a.rowId=e.id;var o=R("button",{title:this.env.t("control.sound_tools.marker_table.entry.bookmark"),$click:this.handlers.onBookmarkRow},[R("span",{className:"material-icons-round inline-icon"},["bookmark_border"])]);o.rowId=e.id;var s=R("input",{placeholder:e.id,value:e.labelText,readOnly:!e.editable,$keydown:this.handlers.onLabelEditKeydown,$input:this.handlers.onLabelEditInput});s.rowId=e.id;for(var l=[n=R("td",{className:"marker-id-col"},[s]),r=R("td",{className:"marker-start-col",title:this.env.t("control.sound_tools.marker_table.jump_to_start"),$click:this.handlers.onSeekToStartTime}),i=R("td",{className:"marker-end-col",title:this.env.t("control.sound_tools.marker_table.jump_to_end"),$click:this.handlers.onSeekToEndTime}),R("td",{className:"marker-buttons-col"},[o,a])],u=0,c=l;u<c.length;u++)c[u].rowId=e.id;return t=R("tr",{},l),{segment:Object.assign({},e),$tr:t,$id:n,$labelEditBox:s,$startTime:r,$endTime:i}}},{key:"insertRow",value:function(e){if(void 0!==this.$body){for(var t=!1,n=0,r=Object.values(this.rows);n<r.length;n++){var i=r[n];if(e!==i&&this.cmpSegment(e.segment,i.segment)<0){this.$body.insertBefore(e.$tr,i.$tr),t=!0;break}}t||this.$body.append(e.$tr)}}},{key:"removeRowById",value:function(e){if(void 0!==e){var t=this.rows[e];void 0!==t&&this.removeRow(t)}}},{key:"clearTable",value:function(){void 0!==this.$body&&(this.$body.innerHTML=""),this.rows={},this.rowCount=0,this.update()}},{key:"removeRow",value:function(e){e.$tr.remove(),delete this.rows[e.segment.id],this.rowCount--,this.update()}},{key:"getEmptyTableHTML",value:function(){if(!(this.player instanceof $t))return"";var e=this.player.getKeybindings(),t=e.find((function(e){return"sound_tools.segments.add"===e.action})),n=e.find((function(e){return"sound_tools.segments.close"===e.action}));return b(R("span",{innerText:this.env.t("control.sound_tools.marker_table.empty",{keybindingAdd:"{keybindingAdd}",keybindingClose:"{keybindingClose}"})}).innerHTML,{keybindingAdd:t?mt(this.env,t).innerHTML:"",keybindingClose:n?mt(this.env,n).innerHTML:""})}},{key:"update",value:function(){null!==this.$container&&Z(this.$container,"is-empty",0===this.rowCount)}},{key:"cmpSegment",value:function(e,t){var n,r;return g(e.startTime,t.startTime)||g(null!==(n=e.endTime)&&void 0!==n?n:e.startTime,null!==(r=t.endTime)&&void 0!==r?r:t.startTime)}}]),l}(Ge);customElements.define("dlf-marker-table",Nt);var Lt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,a.Z)(this,e),this.initial_=t,this.value_=t,this.updateFn_=n}return(0,o.Z)(e,[{key:"initial",get:function(){return this.initial_}},{key:"value",get:function(){return this.value_}},{key:"editable",get:function(){return null!==this.updateFn_}},{key:"initialize",value:function(e){this.initial_=e,this.value_=e}},{key:"update",value:function(e){var t=this;if(null!==this.updateFn_){var n=this.value_,r=e(n);this.value_=r,this.updateFn_(n,r,(function(e){t.value_=e}))}}}]),e}(),Dt=function(){function e(t){(0,a.Z)(this,e),this.audioContext_=t,this.bands_=[],this.prevNode_=null,this.fallbackNode_=new GainNode(t)}return(0,o.Z)(e,[{key:"gain",get:function(){return 1}},{key:"nodes",get:function(){return this.bands_.map((function(e){return e.node}))}},{key:"parameters",get:function(){return this.bands_.map((function(e){return e.param}))}},{key:"inputNode",get:function(){var e;return null!==(e=this.nodes[0])&&void 0!==e?e:this.fallbackNode_}},{key:"outputNode",get:function(){var e;return null!==(e=this.nodes[this.nodes.length-1])&&void 0!==e?e:this.fallbackNode_}},{key:"targetCurve",value:function(e){return null}},{key:"getBands",value:function(){return this.bands_.map((function(t){return{frequency:t.options.frequency,octaves:e.qToOctaves(t.options.Q),gain:t.options.gain}}))}},{key:"autofill",value:function(e){this.addBand(1e3,e,0);for(var t=1;;t++){for(var n=!1,r=0,i=[-1,1];r<i.length;r++){var a=i[r],o=1e3*Math.pow(2,a*t*e);20<=o&&o<=2e4&&(this.addBand(o,e,0),n=!0)}if(!n)break}}},{key:"addBand",value:function(t,n,r){var i=this,a={type:"peaking",frequency:t,gain:r,Q:e.octavesToQ(n)},o=(a.Q,new BiquadFilterNode(this.audioContext_,a));null!==this.prevNode_&&this.prevNode_.connect(o),this.prevNode_=o,this.bands_.push({node:o,param:{isActive:!0,frequency:new Lt(a.frequency),gain:new Lt(a.gain,(function(e,t){o.gain.value=a.gain=t})),getFrequencyResponse:function(e){return e.aggregate([o]).makeCurve(i.gain)}},options:a})}}],[{key:"octavesToQ",value:function(e){var t=Math.pow(2,-e/2);return 1/(Math.pow(2,e/2)-t)}},{key:"qToOctaves",value:function(e){return Math.asinh(1/e/2)/(Math.LN2/2)}}]),e}();function Ut(e,t){return 1/Math.sqrt((e+1/e)*(1/t-1)+2)}function Vt(e){for(var t=e.feedback[0],n=0;n<3;n++)e.feedback[n]/=t,e.feedforward[n]/=t;return e}function Gt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ht=["deepBaseRolloff","baseBoostRolloff","baseBoost","trebleCut"],Wt=function(){function e(t){var n=this;(0,a.Z)(this,e),this.audioContext_=t,this.processorNode=new AudioWorkletNode(t,"multi-iir-processor"),this.pp={deepBaseRolloff:this.makeParam("base",50),baseBoostRolloff:this.makeParam("mid",1e3,(function(){return[0,n.pp.baseBoost.frequency.value-.01]})),baseBoost:this.makeParam("mid",2e3,(function(){return[n.pp.baseBoostRolloff.frequency.value+.01,Number.POSITIVE_INFINITY]})),trebleCut:this.makeParam("treble",5e3)},this.parameters_=[this.pp.deepBaseRolloff,this.pp.baseBoostRolloff,this.pp.baseBoost,this.pp.trebleCut],this.gain_=1,this.keyedFilters_=this.createFilters(),this.updateFilters()}return(0,o.Z)(e,[{key:"inputNode",get:function(){return this.processorNode}},{key:"outputNode",get:function(){return this.processorNode}},{key:"nodes",get:function(){return Object.values(this.keyedFilters_).filter((function(e){return e.isActive})).map((function(e){return e.node}))}},{key:"parameters",get:function(){return this.parameters_}},{key:"gain",get:function(){return this.gain_}},{key:"targetCurve",value:function(e){for(var t={name:"RIAA Target",points:[]},n=this.single(1e3),r=0;r<e.length;r++){var i=e[r],a=this.single(i)-n;t.points.push({freq:i,gain:a,phase:0})}return t}},{key:"resetTc",value:function(e){var t,n,r=Gt(Ht);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e[i];if(null==a)this.pp[i].isActive=!1;else{var o=(n=a/1e6,1/(2*Math.PI*n));this.pp[i].isActive=!0,this.pp[i].frequency.initialize(o)}}}catch(e){r.e(e)}finally{r.f()}this.pp.baseBoost.isActive?this.pp.baseBoostRolloff.isActive||this.pp.baseBoostRolloff.frequency.initialize(10):this.pp.baseBoostRolloff.isActive=!1,this.keyedFilters_=this.createFilters(),this.updateFilters()}},{key:"getTc",value:function(){var e,t,n={},r=Gt(Ht);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i]=this.pp[i].isActive?1e6*(t=this.pp[i].frequency.value,1/(2*Math.PI*t)):null}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"makeParam",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY]};return{isActive:!1,frequency:new Lt(t,(function(t,i,a){a(y(i,r())),n.keyedFilters_[e]=n.makeFilter(e),n.keyedFilters_[e].isActive=!0,n.updateFilters()})),gain:new Lt(0),getFrequencyResponse:function(t){var r,i,a=null!==(r=null===(i=n.keyedFilters_[e])||void 0===i?void 0:i.node)&&void 0!==r?r:null;return null===a?{name:"Frequency Response",points:[]}:t.aggregate([a]).makeCurve(n.gain_)}}}},{key:"updateFilters",value:function(){var e=this.single(1e3);this.gain_=Math.pow(10,-e/20),this.processorNode.port.postMessage({type:"filters",gain:this.gain_,filters:this.keyedFilters_})}},{key:"createFilters",value:function(){var e={base:this.makeFilter("base"),mid:this.makeFilter("mid"),treble:this.makeFilter("treble")};return e.base.isActive=this.pp.deepBaseRolloff.isActive,e.mid.isActive=this.pp.baseBoost.isActive,e.treble.isActive=this.pp.trebleCut.isActive,e}},{key:"makeFilter",value:function(e){switch(e){case"base":return this.makeBaseFilter();case"mid":return this.makeMidFilter();case"treble":return this.makeTrebleFilter()}}},{key:"makeBaseFilter",value:function(){return{isActive:!1,node:(e={frequency:this.pp.deepBaseRolloff.frequency.value,sampleRate:this.audioContext_.sampleRate},t=e.frequency,n=e.sampleRate,r=2*Math.PI*(t/n),Vt({type:"iir",sampleRate:n,feedforward:[1,-1,0],feedback:[(r=Math.tan(r/2))+1,r-1,0]}))};var e,t,n,r}},{key:"makeMidFilter",value:function(){var e,t,n,r,i,a,o,s,l,u,c,d=10*Math.log10(1+Math.pow(this.pp.baseBoost.frequency.value,2))-10*Math.log10(1+Math.pow(this.pp.baseBoostRolloff.frequency.value,2)),h=d/2;return{isActive:!1,node:(e={frequency:Math.sqrt(Math.pow(this.pp.baseBoost.frequency.value,2)-Math.pow(this.pp.baseBoostRolloff.frequency.value,2)*Math.pow(10,h/10))/Math.sqrt(Math.pow(10,h/10)-1),gain:d,S:.5,sampleRate:this.audioContext_.sampleRate},t=e.frequency,n=e.gain,r=e.S,i=e.sampleRate,a=2*Math.PI*(t/i),o=Math.pow(10,n/40),s=Ut(o,r),l=Math.cos(a),u=Math.sin(a)/2*(1/s),c=2*Math.sqrt(o)*u,Vt({type:"iir",sampleRate:i,feedforward:[o*(o+1-(o-1)*l+c),2*o*(o-1-(o+1)*l),o*(o+1-(o-1)*l-c)],feedback:[o+1+(o-1)*l+c,-2*(o-1+(o+1)*l),o+1+(o-1)*l-c]}))}}},{key:"makeTrebleFilter",value:function(){var e,t,n,r,i,a,o,s,l,u,c,d=this.single(2e4),h=d/2;return{isActive:!1,node:(e={frequency:Math.sqrt(Math.pow(10,-h/10)-1)*this.pp.trebleCut.frequency.value,gain:d,S:.5,sampleRate:this.audioContext_.sampleRate},t=e.frequency,n=e.gain,r=e.S,i=e.sampleRate,a=2*Math.PI*(t/i),o=Math.pow(10,n/40),s=Ut(o,r),l=Math.cos(a),u=Math.sin(a)/2*(1/s),c=2*Math.sqrt(o)*u,Vt({type:"iir",sampleRate:i,feedforward:[o*(o+1+(o-1)*l+c),-2*o*(o-1+(o+1)*l),o*(o+1+(o-1)*l-c)],feedback:[o+1-(o-1)*l+c,2*(o-1-(o+1)*l),o+1-(o-1)*l-c]}))}}},{key:"single",value:function(e){var t=0;return this.pp.deepBaseRolloff.isActive&&(t-=10*Math.log10(1+Math.pow(this.pp.deepBaseRolloff.frequency.value/e,2))),this.pp.baseBoost.isActive&&(t+=10*Math.log10(1+Math.pow(this.pp.baseBoost.frequency.value/e,2)),t-=10*Math.log10(1+Math.pow(this.pp.baseBoostRolloff.frequency.value/e,2))),this.pp.trebleCut.isActive&&(t-=10*Math.log10(1+Math.pow(e/this.pp.trebleCut.frequency.value,2))),t}}]),e}();function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qt=function(){function e(t){(0,a.Z)(this,e),this.source_=t,this.audioContext_=t.context,this.fftSize_=8192,this.fftData_=new Float32Array(this.fftSize_),this.connection_=null,this.active_=!1,this.filterset_=new Dt(this.audioContext_)}return(0,o.Z)(e,[{key:"audioContext",get:function(){return this.audioContext_}},{key:"active",get:function(){return this.active_},set:function(e){e!==this.active_&&(this.active_=e,e?this.activate():this.deactivate())}},{key:"filterset",get:function(){return this.filterset_}},{key:"activeParams",get:function(){return this.filterset_.parameters.filter((function(e){return e.isActive}))}},{key:"getFrequencyResponse",value:function(e){return e.aggregate(this.filterset_.nodes).makeCurve(this.filterset.gain)}},{key:"connect",value:function(e){var t=this.audioContext_.createAnalyser();t.smoothingTimeConstant=0,t.fftSize=this.fftSize_,this.connection_={destination:e,analyzer:t},this.source_.connect(t),t.connect(e)}},{key:"setFilters",value:function(e){this.deactivate(),this.filterset_=e,this.active_&&this.activate()}},{key:"loadPreset",value:function(e){var t;switch(e.mode){case"riaa":(t=new Wt(this.audioContext)).resetTc(e.params);break;case"band-iso":(t=new Dt(this.audioContext)).autofill(e.octaveStep);break;case"band":t=new Dt(this.audioContext);var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e.bands);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.addBand(i.frequency,i.octaves,i.gain)}}catch(e){r.e(e)}finally{r.f()}}this.setFilters(t)}},{key:"exportPreset",value:function(e){var t={group:"user",label:e};return this.filterset_ instanceof Dt?Xt(Xt({},t),{},{mode:"band",bands:this.filterset_.getBands()}):this.filterset_ instanceof Wt?Xt(Xt({},t),{},{mode:"riaa",params:this.filterset_.getTc()}):null}},{key:"fft",value:function(e){if(null===this.connection_)return null;this.connection_.analyzer.getFloatFrequencyData(this.fftData_);for(var t={name:"FFT",points:[]},n=0;n<this.fftData_.length;n++){var r=this.fftData_[n];t.points.push({freq:this.audioContext.sampleRate/this.fftData_.length*n,gain:e+r,phase:0})}return t}},{key:"deactivate",value:function(){null!==this.connection_&&(this.source_.disconnect(),this.source_.connect(this.connection_.analyzer))}},{key:"activate",value:function(){if(null!==this.connection_){var e=this.connection_.analyzer;this.source_.disconnect(),this.source_.connect(this.filterset_.inputNode),this.filterset_.outputNode.connect(e)}}}]),e}(),Jt={convert:function(e){return e<=0?Number.NEGATIVE_INFINITY:Math.log(e)},invert:Math.exp},en={convert:function(e){return e},invert:function(e){return e}},tn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:en;(0,a.Z)(this,e),this.skew=o,this.inputMin_=t,this.inputMax_=n,this.outputMin_=r,this.inputMinConv_=this.skew.convert(t),this.convScale_=(i-r)/(this.skew.convert(this.inputMax_)-this.inputMinConv_)}return(0,o.Z)(e,[{key:"max",get:function(){return this.inputMax_}},{key:"convert",value:function(e){return(this.skew.convert(e)-this.inputMinConv_)*this.convScale_+this.outputMin_}},{key:"invert",value:function(e){return this.skew.invert((e-this.outputMin_)/this.convScale_+this.inputMinConv_)}}]),e}();function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rn=function(){function e(t){(0,a.Z)(this,e),this.numPoints=t,this.frequencies_=new Float32Array(t),this.bufMagnitude_=new Float32Array(t),this.bufPhase_=new Float32Array(t),this.magnitudeResponse_=new Float32Array(t),this.phaseResponse_=new Float32Array(t)}return(0,o.Z)(e,[{key:"setFrequency",value:function(e,t){this.frequencies_[e]=t}},{key:"setFrequencies",value:function(e){this.frequencies_=e}},{key:"aggregate",value:function(e){this.magnitudeResponse_.fill(1),this.phaseResponse_.fill(0);var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i instanceof BiquadFilterNode)i.getFrequencyResponse(this.frequencies_,this.bufMagnitude_,this.bufPhase_);else for(var a=0;a<this.frequencies_.length;a++){var o=this.frequencies_[a],s=2*Math.PI*o/i.sampleRate,l=this.fft(i.feedforward,s),u=(0,r.Z)(l,2),c=u[0],d=u[1],h=this.fft(i.feedback,s),f=(0,r.Z)(h,2),v=f[0],p=f[1],m=c*v+d*p,y=d*v-c*p,g=Math.sqrt(Math.pow(m,2)+Math.pow(y,2))/(Math.pow(v,2)+Math.pow(p,2)),b=Math.atan2(y,m);this.bufMagnitude_[a]=g,this.bufPhase_[a]=b}for(var k=0;k<this.numPoints;k++)this.magnitudeResponse_[k]*=this.bufMagnitude_[k],this.phaseResponse_[k]+=this.bufPhase_[k]}}catch(e){n.e(e)}finally{n.f()}return this}},{key:"fft",value:function(e,t){for(var n=0,r=0,i=0;i<e.length;i++){var a=e[i];n+=a*Math.cos(-i*t),r+=a*Math.sin(-i*t)}return[n,r]}},{key:"makeCurve",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t={name:"Frequency Response",points:[]},n=0;n<this.numPoints;n++){var r=this.magnitudeResponse_[n],i=this.magToDb(r*e),a=this.phaseResponse_[n];t.points.push({freq:this.frequencies_[n],gain:i,phase:a})}return t}},{key:"magToDb",value:function(e){return 20*Math.log10(e)}}]),e}();function an(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?an(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):an(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ln(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ln(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var un=function(e){(0,u.Z)(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function i(e,t){var n;(0,a.Z)(this,i),(n=r.call(this)).env=e,n.eq_=t,n.handlers={onCanvasMouseMove:n.onCanvasMouseMove.bind((0,s.Z)(n)),onCanvasMouseLeave:n.onCanvasMouseLeave.bind((0,s.Z)(n)),onCanvasMouseDown:n.onCanvasMouseDown.bind((0,s.Z)(n)),onCanvasMouseUp:n.onCanvasMouseUp.bind((0,s.Z)(n)),onCanvasDoubleClick:n.onCanvasDoubleClick.bind((0,s.Z)(n)),onCanvasWheel:n.onCanvasWheel.bind((0,s.Z)(n)),onChangeActivate:n.onChangeActivate.bind((0,s.Z)(n)),onSelectPreset:n.onSelectPreset.bind((0,s.Z)(n)),onResetPreset:n.onResetPreset.bind((0,s.Z)(n)),onSavePreset:n.onSavePreset.bind((0,s.Z)(n)),onDeletePreset:n.onDeletePreset.bind((0,s.Z)(n)),onResizeWindow:n.resize.bind((0,s.Z)(n))};var o={activateCheck:n.env.mkid(),presetSelect:n.env.mkid(),labelInput:n.env.mkid()};return n.$container=R("div",{className:"dlf-equalizer-view"},[R("h2",{},[n.env.t("control.sound_tools.equalizer.title")]),R("section",{className:"eq-controls"},[R("div",{className:"eq-preset"},[R("label",{htmlFor:o.presetSelect},[n.env.t("control.sound_tools.equalizer.preset.label")]),n.$presetSelect=R("select",{id:o.presetSelect,$change:n.handlers.onSelectPreset},[]),R("button",{title:n.env.t("control.sound_tools.equalizer.preset.reset"),$click:n.handlers.onResetPreset},[R("span",{className:"material-icons-round inline-icon"},["settings_backup_restore"])]),R("button",{title:n.env.t("control.sound_tools.equalizer.preset.save"),$click:n.handlers.onSavePreset},[R("span",{className:"material-icons-round inline-icon"},["save_as"])]),n.$deletePresetBtn=R("button",{disabled:!0,title:n.env.t("control.sound_tools.equalizer.preset.delete"),$click:n.handlers.onDeletePreset},[R("span",{className:"material-icons-round inline-icon"},["delete"])])]),R("div",{className:"eq-activate"},[n.$activateCheck=R("input",{id:o.activateCheck,type:"checkbox",checked:n.eq_.active,$input:n.handlers.onChangeActivate}),R("label",{htmlFor:o.activateCheck},[n.env.t("control.sound_tools.equalizer.activate")])])]),n.$canvas=R("canvas",{width:1e3,height:400,$mousemove:n.handlers.onCanvasMouseMove,$mouseleave:n.handlers.onCanvasMouseLeave,$mousedown:n.handlers.onCanvasMouseDown,$dblclick:n.handlers.onCanvasDoubleClick,$mouseup:n.handlers.onCanvasMouseUp,$wheel:n.handlers.onCanvasWheel})]),n.$ctx=n.$canvas.getContext("2d"),n.eqBox=n.calcEqBox(),n.resizeAnimationFrame=null,n.renderAnimationFrame=null,n.hovered=null,n.NUM_POINTS=1e3,n.db=new tn,n.phase=new tn,n.freq=new tn,n.frequencies=new Float32Array(n.NUM_POINTS),n.frequencyResponse=new rn(n.NUM_POINTS),n.singleFrequencyResponse=new rn(1),n.frequencyResponseCurve=n.frequencyResponse.makeCurve(),n.presets={selected:null,keyToPreset:{},domGroups:{}},n.addPresetOptgroup("user"),n.setHovered(null),n.initFrequencies(),window.addEventListener("resize",n.handlers.onResizeWindow),n}return(0,o.Z)(i,[{key:"domElement",get:function(){return this.$container}},{key:"resize",value:function(){var e=this;null===this.resizeAnimationFrame&&(this.resizeAnimationFrame=requestAnimationFrame((function(){e.resizeAnimationFrame=null;var t=y(e.$container.offsetWidth-100,[100,1e3]),n=y(.4*t,[200,400]);e.$canvas.width=t,e.$canvas.height=n,e.eqBox=e.calcEqBox(),e.initFrequencies()})))}},{key:"calcEqBox",value:function(){return new DOMRect(40,0,this.$canvas.width-40,this.$canvas.height-20)}},{key:"initFrequencies",value:function(){var e=this.eq_.audioContext.sampleRate/2;this.db=new tn(-24,24,this.eqBox.bottom,this.eqBox.top,en),this.phase=new tn(-2*Math.PI,2*Math.PI,this.eqBox.bottom,this.eqBox.top,en),this.freq=new tn(10,e,this.eqBox.left,this.eqBox.right,Jt);for(var t=new tn(10,e,0,this.NUM_POINTS-1,Jt),n=0;n<this.NUM_POINTS;n++)this.frequencies[n]=t.invert(n);this.frequencyResponse.setFrequencies(this.frequencies),this.updateFrequencyResponse()}},{key:"onChangeActivate",value:function(e){this.eq_.active=this.$activateCheck.checked}},{key:"onCanvasMouseMove",value:function(e){var t={freqX:e.offsetX,gainY:e.offsetY};if(null!==this.hovered&&this.hovered.grabbed){var n=this.db.invert(t.gainY+(this.hovered.grabbed.filter.gainY-this.hovered.grabbed.pointer.gainY));this.updateFilterGain(this.hovered.param,(function(){return n}));var r=this.freq.invert(t.freqX+(this.hovered.grabbed.filter.freqX-this.hovered.grabbed.pointer.freqX));this.updateFilterFreq(this.hovered.param,(function(){return r}))}else{var i,a=this.freq.invert(t.freqX),o=null,s=sn(this.eq_.activeParams);try{for(s.s();!(i=s.n()).done;){var l=i.value,u={grabbed:null,pointer:t,dist:Math.abs(l.frequency.value-a),param:l};(null===o||u.dist<=o.dist)&&(o=u)}}catch(e){s.e(e)}finally{s.f()}this.setHovered(o)}}},{key:"onCanvasMouseLeave",value:function(e){this.setHovered(null)}},{key:"onCanvasMouseDown",value:function(e){if(null!==this.hovered){var t={freqX:e.offsetX,gainY:e.offsetY},n={gainY:this.db.convert(this.hovered.param.gain.value),freqX:this.freq.convert(this.hovered.param.frequency.value)};this.setHovered(on(on({},this.hovered),{},{grabbed:{pointer:t,filter:n}}))}}},{key:"onCanvasMouseUp",value:function(e){var t;null!=(null===(t=this.hovered)||void 0===t?void 0:t.grabbed)&&this.setHovered(on(on({},this.hovered),{},{grabbed:null}))}},{key:"onCanvasDoubleClick",value:function(e){var t,n=null===(t=this.hovered)||void 0===t?void 0:t.param;null!=n&&(this.updateFilterGain(n,(function(){return n.gain.initial})),this.updateFilterFreq(n,(function(){return n.frequency.initial})))}},{key:"onCanvasWheel",value:function(e){if(null!==this.hovered&&null===this.hovered.grabbed){e.preventDefault();var t=e.deltaY/4,n=this.db.invert(this.eqBox.height/2-t);Math.abs(n)>1&&(n/=5),this.updateFilterGain(this.hovered.param,(function(e){return e-n}))}}},{key:"setHovered",value:function(e){this.hovered=e,null!=e&&e.grabbed?this.$canvas.style.cursor="grab":this.$canvas.style.cursor="pointer",this.scheduleRenderGraph()}},{key:"updateFilterGain",value:function(e,t){this.updateEqValue(e.gain,t,[-24,24])}},{key:"updateFilterFreq",value:function(e,t){this.updateEqValue(e.frequency,t,[10,this.freq.max])}},{key:"updateEqValue",value:function(e,t,n){e.editable&&(e.update((function(e){return y(t(e),n)})),this.updateFrequencyResponse())}},{key:"onSelectPreset",value:function(e){this.selectPreset(this.$presetSelect.value)}},{key:"onResetPreset",value:function(e){this.selectPreset(this.$presetSelect.value,"original")}},{key:"onSavePreset",value:function(e){var t=prompt(this.env.t("control.sound_tools.equalizer.preset.save.name"));if(t){var n=this.eq_.exportPreset(t);if(null!==n){var r=this.addPreset(n);this.selectPreset(r),this.dispatchEvent(new CustomEvent("store_preset",{detail:{key:r,preset:n}}))}}}},{key:"onDeletePreset",value:function(e){var t,n,r=this.$presetSelect.value,i=this.presets.keyToPreset[r];void 0!==i&&"user"===i.original.group&&(null===(t=this.presets.domGroups[i.original.group])||void 0===t||null===(n=t.querySelector('option[value="'.concat(r,'"]')))||void 0===n||n.remove(),this.selectPreset(this.$presetSelect.value),this.dispatchEvent(new CustomEvent("delete_preset",{detail:{key:r}})))}},{key:"addPreset",value:function(e){var t,n=null!==(t=e.key)&&void 0!==t?t:this.env.uuidv4();this.presets.keyToPreset[n]={original:e,modified:e};var r=this.presets.domGroups[e.group];void 0===r&&(r=this.addPresetOptgroup(e.group));var i=R("option",{value:n},[e.label]);return r.append(i),n}},{key:"selectPreset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modified";if(null!==this.presets.selected){var n=this.eq_.exportPreset("");null!==n&&(this.presets.selected.modified=n)}var r=this.presets.keyToPreset[e];void 0!==r&&(this.presets.selected=r,this.eq_.loadPreset(r[t]),r.modified=r[t],this.$presetSelect.value=e,this.$deletePresetBtn.disabled="user"!==r.original.group,this.updateFrequencyResponse())}},{key:"addPresetOptgroup",value:function(e){var t=R("optgroup",{label:this.env.t("control.sound_tools.equalizer.preset.group.".concat(e))},[]);return this.presets.domGroups[e]=t,this.$presetSelect.appendChild(t),t}},{key:"fftSnapshot",value:function(e){this.fftCurve=this.eq_.fft(e),this.scheduleRenderGraph()}},{key:"updateFrequencyResponse",value:function(){this.frequencyResponseCurve=this.eq_.getFrequencyResponse(this.frequencyResponse),this.scheduleRenderGraph()}},{key:"scheduleRenderGraph",value:function(){var e=this;null===this.renderAnimationFrame&&(this.renderAnimationFrame=requestAnimationFrame((function(){e.renderGraph(),e.renderAnimationFrame=null})))}},{key:"renderGraph",value:function(){if(null!==this.$ctx){var e=this.eqBox;this.$ctx.clearRect(0,0,this.$canvas.width,this.$canvas.height);for(var t=-24;t<=24;t+=6){var n=this.db.convert(t);this.$ctx.strokeStyle="#ddd",this.$ctx.beginPath(),this.$ctx.moveTo(e.left,n),this.$ctx.lineTo(e.right,n),this.$ctx.stroke();var r=n+4;t>0?r=n+10:t<0&&(r=n),this.$ctx.font="12px Arial",this.$ctx.fillStyle="#aaa",this.$ctx.textAlign="right",this.$ctx.fillText("".concat(t," dB"),e.left-4,r,e.width)}for(var i=0,a=[10,100,1e3,1e4];i<a.length;i++){for(var o=a[i],s=1;s<10;s++){this.$ctx.strokeStyle=s<=1?"#aaa":"#ddd";var l=this.freq.convert(o*s);this.$ctx.beginPath(),this.$ctx.moveTo(l,this.eqBox.top),this.$ctx.lineTo(l,this.eqBox.bottom),this.$ctx.stroke()}this.$ctx.font="12px Arial",this.$ctx.textAlign="left",this.$ctx.fillStyle="#aaa";var u=this.freq.convert(o);this.$ctx.fillText("".concat(o," Hz"),u,e.bottom+12)}var c=this.eq_.filterset.targetCurve(this.frequencies);if(null!==c&&this.drawEqCurve(c),this.$ctx.strokeStyle="black",this.drawEqCurve(this.frequencyResponseCurve,"gain"),this.$ctx.setLineDash([5,15]),this.drawEqCurve(this.frequencyResponseCurve,"phase"),this.$ctx.setLineDash([]),null!==this.hovered){var d=this.hovered.param.getFrequencyResponse(this.frequencyResponse);this.$ctx.strokeStyle="transparent",this.$ctx.fillStyle="rgba(0, 0, 0, 0.1)",this.fillEqCurve(d)}if(null!==this.hovered){var h=this.freq.invert(this.hovered.pointer.freqX),f=h.toLocaleString(void 0,{maximumFractionDigits:0});this.singleFrequencyResponse.setFrequency(0,h);var v=this.eq_.getFrequencyResponse(this.singleFrequencyResponse).points[0];if(void 0!==v){var p=v.gain.toLocaleString(void 0,{maximumFractionDigits:1,signDisplay:"exceptZero"}),m=(v.phase/Math.PI*180).toLocaleString(void 0,{maximumFractionDigits:0});this.$ctx.font="12px Arial",this.$ctx.fillStyle="rgba(0, 0, 0, 0.4)",this.$ctx.textAlign="left",this.$ctx.fillText("".concat(f," Hz: ").concat(p," dB, ").concat(m,"°"),e.left+2,e.top+12)}}var y,g=sn(this.eq_.activeParams);try{for(g.s();!(y=g.n()).done;){var b,k=y.value,w=this.freq.convert(k.frequency.value),S=this.db.convert(k.gain.value);this.$ctx.fillStyle=k===(null===(b=this.hovered)||void 0===b?void 0:b.param)?"red":"blue",this.$ctx.beginPath(),this.$ctx.arc(w,S,3,0,2*Math.PI),this.$ctx.fill()}}catch(e){g.e(e)}finally{g.f()}this.fftCurve&&(this.$ctx.strokeStyle="green",this.drawEqCurve(this.fftCurve))}}},{key:"fillEqCurve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gain";if(null!==this.$ctx){var n=e.points[0],r=e.points[e.points.length-1];n&&r&&(e.points.splice(0,0,{freq:n.freq,gain:0,phase:0}),e.points.push({freq:r.freq,gain:0,phase:0})),this.drawEqCurve(e,t),this.$ctx.closePath(),this.$ctx.fill()}}},{key:"drawEqCurve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gain";if(null!==this.$ctx){this.$ctx.beginPath();var n,r=!0,i=sn(e.points);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.freq.convert(a.freq),s="gain"===t?this.db.convert(a.gain):this.phase.convert(a.phase);r?(this.$ctx.moveTo(o,s),r=!1):this.$ctx.lineTo(o,s)}}catch(e){i.e(e)}finally{i.f()}this.$ctx.stroke()}}}]),i}(ee);function cn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vn(e){if("object"!==(0,F.Z)(e)||null===e)return null;var t=e.group,n=e.label,r=e.mode;if("string"!=typeof t||"string"!=typeof n)return null;var i={group:t,label:n};if("string"==typeof e.key&&(i.key=e.key),"band-iso"===r){var a=Number(e.octaveStep);if(a>0)return fn(fn({},i),{},{mode:r,octaveStep:a})}else if("band"===r){if(Array.isArray(e.bands)){var o,s=[],l=cn(e.bands);try{for(l.s();!(o=l.n()).done;){var u=o.value;if("object"===(0,F.Z)(u)&&null!==u){var c=Number(u.frequency),d=Number(u.octaves),h=Number(u.gain);c>0&&d>0&&Number.isFinite(h)&&s.push({frequency:c,octaves:d,gain:h})}}}catch(e){l.e(e)}finally{l.f()}return fn(fn({},i),{},{mode:r,bands:s})}}else if("riaa"===r&&"object"===(0,F.Z)(e.params)&&null!==e.params){var f,v={},p=Number.POSITIVE_INFINITY,m=cn(Ht);try{for(m.s();!(f=m.n()).done;){var y=f.value,g=Number(e.params[y]);g<p?(v[y]=g,p=g):v[y]=null}}catch(e){m.e(e)}finally{m.f()}return fn(fn({},i),{},{mode:r,params:v})}return null}function pn(){class e extends AudioWorkletProcessor{constructor(){super(),this.filters={},this.previousGain=1,this.gain=1,this.port.onmessage=this.onmessage.bind(this)}onmessage(e){const t=e.data;if(null!=t&&"filters"===t.type){this.gain=t.gain;for(const e of Object.values(this.filters))e.updated=!1;for(const[e,n]of Object.entries(t.filters)){if(3!==n.node.feedforward.length||3!==n.node.feedback.length){console.warn("MultiIirProcessor: Only IIR filters with three feedforward/feedback coefficients are supported. Skipping filter.");continue}if(1!==n.node.feedback[0]){const e=n.node.feedback[0];for(let t=0;t<3;t++)n.node.feedback[t]/=e,n.node.feedforward[t]/=e}const t=this.filters[e];void 0===t?this.filters[e]={updated:!0,isActive:n.isActive,channels:[],iir:n.node}:(n.isActive&&!t.isActive&&(t.channels=[]),t.updated=!0,t.isActive=n.isActive,t.iir=n.node)}for(const e of Object.values(this.filters))e.updated||(e.isActive=!1)}}process(e,t,n){const r=e[0],i=t[0];if(void 0===r||void 0===i)return console.warn("MultiIirProcessor: input or output not given"),!1;for(let e=0;e<r.length;e++){const t=r[e],n=i[e];for(let r=0;r<t.length;r++){const i=this.previousGain+(this.gain-this.previousGain)*r/t.length;let o=t[r]*i;for(const[t,n]of Object.entries(this.filters)){if(!n.isActive)continue;let t=n.channels[e];void 0===t&&(t=n.channels[e]={buf_0:0,buf_1:0,buf_2:0}),t.buf_0=(a=o-(n.iir.feedback[1]??0)*t.buf_1-(n.iir.feedback[2]??0)*t.buf_2,Math.abs(a)<22250738585072014e-324?0:a),o=n.iir.feedforward[0]*t.buf_0+n.iir.feedforward[1]*t.buf_1+n.iir.feedforward[2]*t.buf_2,t.buf_2=t.buf_1,t.buf_1=t.buf_0}n[r]=o}}var a;return this.previousGain=this.gain,!0}}registerProcessor("multi-iir-processor",e)}function mn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var gn=function(e){(0,u.Z)(p,e);var t,n,i,l,f=(i=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,d.Z)(i);if(l){var n=(0,d.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function p(){var e;return(0,a.Z)(this,p),(e=f.call(this)).presets_=[],e.defaultPreset_=null,e.eqView_=null,e.handlers={onStorePreset:e.onStorePreset.bind((0,s.Z)(e))},e.context=new AudioContext,e.markAsResumed=function(e){},e.resumedPromise=new Promise((function(t){e.markAsResumed=t})),e}return(0,o.Z)(p,[{key:"view",get:function(){return this.eqView_}},{key:"attachToPlayer",value:(n=(0,h.Z)(v().mark((function e(t){var n,i,a,o,s,l,u,c,d,h,f;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https:"!==window.location.protocol&&console.error("Warning: The equalizer will probably fail without HTTPS"),e.next=3,this.resumeAudioContext();case 3:return n=new Blob(["\n      ".concat(pn.toString(),"\n      ").concat(pn.name,"();\n    ")],{type:"application/javascript; charset=utf-8"}),e.next=6,S(n);case 6:return i=e.sent,e.next=9,this.context.audioWorklet.addModule(i);case 9:t.media.crossOrigin="anonymous",a=this.context.createMediaElementSource(t.media),(o=new Qt(a)).connect(this.context.destination),this.eqView_=new un(this.env,o),this.eqView_.addEventListener("store_preset",this.handlers.onStorePreset),s=mn(this.presets_);try{for(s.s();!(l=s.n()).done;)u=l.value,this.eqView_.addPreset(u)}catch(e){s.e(e)}finally{s.f()}for(c=0,d=Object.entries(this.getLocalPresets());c<d.length;c++)(h=(0,r.Z)(d[c],2))[0],f=h[1],this.eqView_.addPreset(f);null!==this.defaultPreset_&&this.eqView_.selectPreset(this.defaultPreset_),this.innerHTML="",this.append(this.eqView_.domElement),this.eqView_.resize();case 22:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"parsePresets",value:function(e){var t;if(Array.isArray(e)){var n=j(e.map(vn));if((t=this.presets_).push.apply(t,(0,re.Z)(n)),null!==this.eqView_){var r,i=mn(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.eqView_.addPreset(a)}}catch(e){i.e(e)}finally{i.f()}}}}},{key:"selectPreset",value:function(e){null===this.eqView_?this.defaultPreset_=e:(this.eqView_.selectPreset(e),this.defaultPreset_=null)}},{key:"resumeAudioContext",value:(t=(0,h.Z)(v().mark((function e(){var t=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"running"===this.context.state?this.markAsResumed():(this.append(R("div",{className:"dlf-equalizer-resume"},[this.env.t("control.sound_tools.equalizer.resume_context")])),this.context.resume().then((function(){t.markAsResumed()}))),window.addEventListener("pointerdown",(0,h.Z)(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.context.resume();case 2:t.markAsResumed();case 3:case"end":return e.stop()}}),e)}))),{once:!0,capture:!0}),window.addEventListener("keydown",(0,h.Z)(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.context.resume();case 2:t.markAsResumed();case 3:case"end":return e.stop()}}),e)}))),{once:!0,capture:!0}),e.next=5,this.resumedPromise;case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onStorePreset",value:function(e){var t=e.detail,n=t.key,r=t.preset;localStorage["dlf.eq.presets.".concat(n)]=JSON.stringify(r)}},{key:"getLocalPresets",value:function(){for(var e={},t=0;t<localStorage.length;t++){var n=localStorage.key(t);if(null!==n&&n.startsWith("dlf.eq.presets."))try{var r=vn(JSON.parse(localStorage[n]));null!==r&&(e[n.substring("dlf.eq.presets.".length)]=r)}catch(e){}}return e}}]),p}(Ge);customElements.define("dlf-equalizer",gn),window.SlubMediaPlayer=$t}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r.m=t,e=[],r.O=(t,n,i,a)=>{if(!n){var o=1/0;for(c=0;c<e.length;c++){for(var[n,i,a]=e[c],s=!0,l=0;l<n.length;l++)(!1&a||o>=a)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(s=!1,a<o&&(o=a));if(s){e.splice(c--,1);var u=i();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,i,a]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={361:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[o,s,l]=n,u=0;if(o.some((t=>0!==e[t]))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);if(l)var c=l(r)}for(t&&t(n);u<o.length;u++)a=o[u],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},n=self.webpackChunkkitodo_presentation=self.webpackChunkkitodo_presentation||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=r.O(void 0,[733],(()=>r(1998)));i=r.O(i)})();
//# sourceMappingURL=DlfMediaPlayer.js.map